"use strict";(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsRepo = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsRepo=(()=>{var op=Object.create;var Dn=Object.defineProperty;var ip=Object.getOwnPropertyDescriptor;var sp=Object.getOwnPropertyNames;var ap=Object.getPrototypeOf,up=Object.prototype.hasOwnProperty;var k=(r,e)=>()=>(r&&(e=r(r=0)),e);var _=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),z=(r,e)=>{for(var t in e)Dn(r,t,{get:e[t],enumerable:!0})},ra=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of sp(e))!up.call(r,o)&&o!==t&&Dn(r,o,{get:()=>e[o],enumerable:!(n=ip(e,o))||n.enumerable});return r};var A=(r,e,t)=>(t=r!=null?op(ap(r)):{},ra(e||!r||!r.__esModule?Dn(t,"default",{value:r,enumerable:!0}):t,r)),te=r=>ra(Dn({},"__esModule",{value:!0}),r);var oa=_((Ng,na)=>{var Jt=1e3,Yt=Jt*60,Zt=Yt*60,Tt=Zt*24,fp=Tt*7,lp=Tt*365.25;na.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return dp(r);if(t==="number"&&isFinite(r))return e.long?hp(r):pp(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function dp(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*lp;case"weeks":case"week":case"w":return t*fp;case"days":case"day":case"d":return t*Tt;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Zt;case"minutes":case"minute":case"mins":case"min":case"m":return t*Yt;case"seconds":case"second":case"secs":case"sec":case"s":return t*Jt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function pp(r){var e=Math.abs(r);return e>=Tt?Math.round(r/Tt)+"d":e>=Zt?Math.round(r/Zt)+"h":e>=Yt?Math.round(r/Yt)+"m":e>=Jt?Math.round(r/Jt)+"s":r+"ms"}function hp(r){var e=Math.abs(r);return e>=Tt?vn(r,e,Tt,"day"):e>=Zt?vn(r,e,Zt,"hour"):e>=Yt?vn(r,e,Yt,"minute"):e>=Jt?vn(r,e,Jt,"second"):r+" ms"}function vn(r,e,t,n){var o=e>=t*1.5;return Math.round(r/t)+" "+n+(o?"s":"")}});var sa=_((Fg,ia)=>{function yp(r){t.debug=t,t.default=t,t.coerce=u,t.disable=i,t.enable=o,t.enabled=s,t.humanize=oa(),t.destroy=f,Object.keys(r).forEach(c=>{t[c]=r[c]}),t.names=[],t.skips=[],t.formatters={};function e(c){let l=0;for(let p=0;p<c.length;p++)l=(l<<5)-l+c.charCodeAt(p),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(c){let l,p=null,D,h;function g(...S){if(!g.enabled)return;let R=g,G=Number(new Date),De=G-(l||G);R.diff=De,R.prev=l,R.curr=G,l=G,S[0]=t.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let J=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(ve,ue)=>{if(ve==="%%")return"%";J++;let Ee=t.formatters[ue];if(typeof Ee=="function"){let Gt=S[J];ve=Ee.call(R,Gt),S.splice(J,1),J--}return ve}),t.formatArgs.call(R,S),(R.log||t.log).apply(R,S)}return g.namespace=c,g.useColors=t.useColors(),g.color=t.selectColor(c),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(D!==t.namespaces&&(D=t.namespaces,h=t.enabled(c)),h),set:S=>{p=S}}),typeof t.init=="function"&&t.init(g),g}function n(c,l){let p=t(this.namespace+(typeof l>"u"?":":l)+c);return p.log=this.log,p}function o(c){t.save(c),t.namespaces=c,t.names=[],t.skips=[];let l,p=(typeof c=="string"?c:"").split(/[\s,]+/),D=p.length;for(l=0;l<D;l++)!p[l]||(c=p[l].replace(/\*/g,".*?"),c[0]==="-"?t.skips.push(new RegExp("^"+c.slice(1)+"$")):t.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...t.names.map(a),...t.skips.map(a).map(l=>"-"+l)].join(",");return t.enable(""),c}function s(c){if(c[c.length-1]==="*")return!0;let l,p;for(l=0,p=t.skips.length;l<p;l++)if(t.skips[l].test(c))return!1;for(l=0,p=t.names.length;l<p;l++)if(t.names[l].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function u(c){return c instanceof Error?c.stack||c.message:c}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}ia.exports=yp});var qe=_((ce,En)=>{ce.formatArgs=gp;ce.save=wp;ce.load=bp;ce.useColors=mp;ce.storage=Dp();ce.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ce.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function mp(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function gp(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+En.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),r.splice(n,0,e)}ce.log=console.debug||console.log||(()=>{});function wp(r){try{r?ce.storage.setItem("debug",r):ce.storage.removeItem("debug")}catch{}}function bp(){let r;try{r=ce.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Dp(){try{return localStorage}catch{}}En.exports=sa()(ce);var{formatters:vp}=En.exports;vp.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Je=_((Lg,ua)=>{"use strict";function aa(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Ep(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return aa(r,t)}catch{t.message=r.message,t.stack=r.stack;let o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(r)),aa(new o,t)}}ua.exports=Ep});function la(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Ap;)e[t++]=r&255|ca,r/=128;for(;r&Cp;)e[t++]=r&255|ca,r>>>=7;return e[t]=r|0,la.bytes=t-n+1,e}function Uo(r,n){var t=0,n=n||0,o=0,i=n,s,a=r.length;do{if(i>=a)throw Uo.bytes=0,new RangeError("Could not decode varint");s=r[i++],t+=o<28?(s&fa)<<o:(s&fa)*Math.pow(2,o),o+=7}while(s>=Op);return Uo.bytes=i-n,t}var _p,ca,xp,Cp,Ap,Sp,Op,fa,Tp,kp,Ip,Pp,Bp,Rp,Np,Fp,Lp,$p,Mp,jp,Ar,da=k(()=>{_p=la,ca=128,xp=127,Cp=~xp,Ap=Math.pow(2,31);Sp=Uo,Op=128,fa=127;Tp=Math.pow(2,7),kp=Math.pow(2,14),Ip=Math.pow(2,21),Pp=Math.pow(2,28),Bp=Math.pow(2,35),Rp=Math.pow(2,42),Np=Math.pow(2,49),Fp=Math.pow(2,56),Lp=Math.pow(2,63),$p=function(r){return r<Tp?1:r<kp?2:r<Ip?3:r<Pp?4:r<Bp?5:r<Rp?6:r<Np?7:r<Fp?8:r<Lp?9:10},Mp={encode:_p,decode:Sp,encodingLength:$p},jp=Mp,Ar=jp});var Sr,Xt,er,xn=k(()=>{da();Sr=r=>[Ar.decode(r),Ar.decode.bytes],Xt=(r,e,t=0)=>(Ar.encode(r,e,t),e),er=r=>Ar.encodingLength(r)});var jg,pa,Ye,ha,ya,ut=k(()=>{jg=new Uint8Array(0),pa=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},Ye=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},ha=r=>new TextEncoder().encode(r),ya=r=>new TextDecoder().decode(r)});var Ue={};z(Ue,{Digest:()=>kt,create:()=>ct,decode:()=>Ze,equals:()=>Ko});var ct,Ze,Ko,kt,Xe=k(()=>{ut();xn();ct=(r,e)=>{let t=e.byteLength,n=er(r),o=n+er(t),i=new Uint8Array(o+t);return Xt(r,i,0),Xt(t,i,n),i.set(e,o),new kt(r,t,e,i)},Ze=r=>{let e=Ye(r),[t,n]=Sr(e),[o,i]=Sr(e.subarray(n)),s=e.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new kt(t,o,s,e)},Ko=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&pa(r.bytes,e.bytes),kt=class{constructor(e,t,n,o){this.code=e,this.size=t,this.digest=n,this.bytes=o}}});function qp(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<r.length;o++){var i=r.charAt(o),s=i.charCodeAt(0);if(t[s]!==255)throw new TypeError(i+" is ambiguous");t[s]=o}var a=r.length,u=r.charAt(0),f=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function l(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var g=0,S=0,R=0,G=h.length;R!==G&&h[R]===0;)R++,g++;for(var De=(G-R)*c+1>>>0,J=new Uint8Array(De);R!==G;){for(var Te=h[R],ve=0,ue=De-1;(Te!==0||ve<S)&&ue!==-1;ue--,ve++)Te+=256*J[ue]>>>0,J[ue]=Te%a>>>0,Te=Te/a>>>0;if(Te!==0)throw new Error("Non-zero carry");S=ve,R++}for(var Ee=De-S;Ee!==De&&J[Ee]===0;)Ee++;for(var Gt=u.repeat(g);Ee<De;++Ee)Gt+=r.charAt(J[Ee]);return Gt}function p(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var g=0;if(h[g]!==" "){for(var S=0,R=0;h[g]===u;)S++,g++;for(var G=(h.length-g)*f+1>>>0,De=new Uint8Array(G);h[g];){var J=t[h.charCodeAt(g)];if(J===255)return;for(var Te=0,ve=G-1;(J!==0||Te<R)&&ve!==-1;ve--,Te++)J+=a*De[ve]>>>0,De[ve]=J%256>>>0,J=J/256>>>0;if(J!==0)throw new Error("Non-zero carry");R=Te,g++}if(h[g]!==" "){for(var ue=G-R;ue!==G&&De[ue]===0;)ue++;for(var Ee=new Uint8Array(S+(G-ue)),Gt=S;ue!==G;)Ee[Gt++]=De[ue++];return Ee}}}function D(h){var g=p(h);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:p,decode:D}}var Up,zp,ma,ga=k(()=>{Up=qp,zp=Up,ma=zp});var Vo,Wo,Qo,wa,Ho,tr,ft,Kp,Vp,L,ke=k(()=>{ga();ut();Vo=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Wo=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return wa(this,e)}},Qo=class{constructor(e){this.decoders=e}or(e){return wa(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},wa=(r,e)=>new Qo({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Ho=class{constructor(e,t,n,o){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new Vo(e,t,n),this.decoder=new Wo(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},tr=({name:r,prefix:e,encode:t,decode:n})=>new Ho(r,e,t,n),ft=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:o}=ma(t,e);return tr({prefix:r,name:e,encode:n,decode:i=>Ye(o(i))})},Kp=(r,e,t,n)=>{let o={};for(let c=0;c<e.length;++c)o[e[c]]=c;let i=r.length;for(;r[i-1]==="=";)--i;let s=new Uint8Array(i*t/8|0),a=0,u=0,f=0;for(let c=0;c<i;++c){let l=o[r[c]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<t|l,a+=t,a>=8&&(a-=8,s[f++]=255&u>>a)}if(a>=t||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return s},Vp=(r,e,t)=>{let n=e[e.length-1]==="=",o=(1<<t)-1,i="",s=0,a=0;for(let u=0;u<r.length;++u)for(a=a<<8|r[u],s+=8;s>t;)s-=t,i+=e[o&a>>s];if(s&&(i+=e[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i},L=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>tr({prefix:e,name:r,encode(o){return Vp(o,n,t)},decode(o){return Kp(o,n,t,r)}})});var Or={};z(Or,{base58btc:()=>ze,base58flickr:()=>Wp});var ze,Wp,Tr=k(()=>{ke();ze=ft({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Wp=ft({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Cn={};z(Cn,{base32:()=>M,base32hex:()=>Jp,base32hexpad:()=>Zp,base32hexpadupper:()=>Xp,base32hexupper:()=>Yp,base32pad:()=>Hp,base32padupper:()=>Gp,base32upper:()=>Qp,base32z:()=>eh});var M,Qp,Hp,Gp,Jp,Yp,Zp,Xp,eh,et=k(()=>{ke();M=L({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Qp=L({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Hp=L({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Gp=L({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Jp=L({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Yp=L({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Zp=L({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xp=L({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eh=L({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Go={};z(Go,{CID:()=>E});var E,th,rh,nh,kr,oh,ba,Da,An,Sn,ih,sh,ah,fe=k(()=>{xn();Xe();Tr();et();ut();E=class{constructor(e,t,n,o){this.code=t,this.version=e,this.multihash=n,this.bytes=o,this.byteOffset=o.byteOffset,this.byteLength=o.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Sn,byteLength:Sn,code:An,version:An,multihash:An,bytes:An,_baseCache:Sn,asCID:Sn})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==kr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==oh)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return E.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=ct(e,t);return E.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ko(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:o}=this;switch(n){case 0:return rh(t,o,e||ze.encoder);default:return nh(t,o,e||M.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return sh(/^0\.0/,ah),!!(e&&(e[Da]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof E)return e;if(e!=null&&e.asCID===e){let{version:t,code:n,multihash:o,bytes:i}=e;return new E(t,n,o,i||ba(t,n,o.bytes))}else if(e!=null&&e[Da]===!0){let{version:t,multihash:n,code:o}=e,i=Ze(n);return E.create(t,o,i)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==kr)throw new Error(`Version 0 CID must use dag-pb (code: ${kr}) block encoding`);return new E(e,t,n,n.bytes)}case 1:{let o=ba(e,t,n.bytes);return new E(e,t,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return E.create(0,kr,e)}static createV1(e,t){return E.create(1,e,t)}static decode(e){let[t,n]=E.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=E.inspectBytes(e),n=t.size-t.multihashSize,o=Ye(e.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");let i=o.subarray(t.multihashSize-t.digestSize),s=new kt(t.multihashCode,t.digestSize,i,o);return[t.version===0?E.createV0(s):E.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[l,p]=Sr(e.subarray(t));return t+=p,l},o=n(),i=kr;if(o===18?(o=0,t=0):o===1&&(i=n()),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let s=t,a=n(),u=n(),f=t+u,c=f-s;return{version:o,codec:i,multihashCode:a,digestSize:u,multihashSize:c,size:f}}static parse(e,t){let[n,o]=th(e,t),i=E.decode(o);return i._baseCache.set(n,e),i}},th=(r,e)=>{switch(r[0]){case"Q":{let t=e||ze;return[ze.prefix,t.decode(`${ze.prefix}${r}`)]}case ze.prefix:{let t=e||ze;return[ze.prefix,t.decode(r)]}case M.prefix:{let t=e||M;return[M.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},rh=(r,e,t)=>{let{prefix:n}=t;if(n!==ze.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let o=e.get(n);if(o==null){let i=t.encode(r).slice(1);return e.set(n,i),i}else return o},nh=(r,e,t)=>{let{prefix:n}=t,o=e.get(n);if(o==null){let i=t.encode(r);return e.set(n,i),i}else return o},kr=112,oh=18,ba=(r,e,t)=>{let n=er(r),o=n+er(e),i=new Uint8Array(o+t.byteLength);return Xt(r,i,0),Xt(e,i,n),i.set(t,o),i},Da=Symbol.for("@ipld/js-cid/CID"),An={writable:!1,configurable:!1,enumerable:!0},Sn={writable:!1,enumerable:!1,configurable:!1},ih="0.0.0-dev",sh=(r,e)=>{if(r.test(ih))console.warn(e);else throw new Error(e)},ah=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Jo={};z(Jo,{identity:()=>uh});var uh,va=k(()=>{ke();ut();uh=tr({prefix:"\0",name:"identity",encode:r=>ya(r),decode:r=>ha(r)})});var Yo={};z(Yo,{base2:()=>ch});var ch,Ea=k(()=>{ke();ch=L({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var Zo={};z(Zo,{base8:()=>fh});var fh,_a=k(()=>{ke();fh=L({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var Xo={};z(Xo,{base10:()=>lh});var lh,xa=k(()=>{ke();lh=ft({prefix:"9",name:"base10",alphabet:"0123456789"})});var ei={};z(ei,{base16:()=>dh,base16upper:()=>ph});var dh,ph,Ca=k(()=>{ke();dh=L({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ph=L({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var ti={};z(ti,{base36:()=>hh,base36upper:()=>yh});var hh,yh,Aa=k(()=>{ke();hh=ft({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yh=ft({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var ri={};z(ri,{base64:()=>mh,base64pad:()=>gh,base64url:()=>wh,base64urlpad:()=>bh});var mh,gh,wh,bh,Sa=k(()=>{ke();mh=L({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gh=L({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wh=L({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bh=L({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var ni={};z(ni,{base256emoji:()=>xh});function Eh(r){return r.reduce((e,t)=>(e+=Dh[t],e),"")}function _h(r){let e=[];for(let t of r){let n=vh[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}var Oa,Dh,vh,xh,Ta=k(()=>{ke();Oa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Dh=Oa.reduce((r,e,t)=>(r[t]=e,r),[]),vh=Oa.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);xh=tr({prefix:"\u{1F680}",name:"base256emoji",encode:Eh,decode:_h})});var ii,oi,si=k(()=>{Xe();ii=({name:r,code:e,encode:t})=>new oi(r,e,t),oi=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?ct(this.code,t):t.then(n=>ct(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var ai={};z(ai,{sha256:()=>rr,sha512:()=>Ch});var Ia,rr,Ch,Tn=k(()=>{si();Ia=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),rr=ii({name:"sha2-256",code:18,encode:Ia("SHA-256")}),Ch=ii({name:"sha2-512",code:19,encode:Ia("SHA-512")})});var ci={};z(ci,{identity:()=>ui});var Pa,Ah,Ba,Sh,ui,fi=k(()=>{ut();Xe();Pa=0,Ah="identity",Ba=Ye,Sh=r=>ct(Pa,Ba(r)),ui={code:Pa,name:Ah,encode:Ba,digest:Sh}});var li,kn=k(()=>{ut();li=85});var pw,hw,Ra=k(()=>{pw=new TextEncoder,hw=new TextDecoder});var In=k(()=>{fe();xn();ut();si();Xe()});var pi,ww,Na=k(()=>{va();Ea();_a();xa();Ca();et();Aa();Tr();Sa();Ta();Tn();fi();kn();Ra();In();pi={...Jo,...Yo,...Zo,...Xo,...ei,...Cn,...ti,...Or,...ri,...ni},ww={...ai,...ci}});function Pn(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}var hi=k(()=>{});function La(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var Fa,yi,Th,Bn,mi=k(()=>{Na();hi();Fa=La("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),yi=La("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=Pn(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Th={utf8:Fa,"utf-8":Fa,hex:pi.base16,latin1:yi,ascii:yi,binary:yi,...pi},Bn=Th});var Ir={};z(Ir,{toString:()=>re});function re(r,e="utf8"){let t=Bn[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var _e=k(()=>{mi()});var $a={};z($a,{fromString:()=>Y});function Y(r,e="utf8"){let t=Bn[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var Ke=k(()=>{mi()});var gi=_((kw,ja)=>{"use strict";var Bh=async r=>{let e=0;for await(let t of r)e++;return e};ja.exports=Bh});var sc=_((zb,ic)=>{"use strict";ic.exports=_y;function _y(r,e){for(var t=new Array(arguments.length-1),n=0,o=2,i=!0;o<arguments.length;)t[n++]=arguments[o++];return new Promise(function(a,u){t[n]=function(c){if(i)if(i=!1,c)u(c);else{for(var l=new Array(arguments.length-1),p=0;p<l.length;)l[p++]=arguments[p];a.apply(null,l)}};try{r.apply(e||null,t)}catch(f){i&&(i=!1,u(f))}})}});var fc=_(cc=>{"use strict";var Wn=cc;Wn.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var fr=new Array(64),uc=new Array(123);for(Be=0;Be<64;)uc[fr[Be]=Be<26?Be+65:Be<52?Be+71:Be<62?Be-4:Be-59|43]=Be++;var Be;Wn.encode=function(e,t,n){for(var o=null,i=[],s=0,a=0,u;t<n;){var f=e[t++];switch(a){case 0:i[s++]=fr[f>>2],u=(f&3)<<4,a=1;break;case 1:i[s++]=fr[u|f>>4],u=(f&15)<<2,a=2;break;case 2:i[s++]=fr[u|f>>6],i[s++]=fr[f&63],a=0;break}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0)}return a&&(i[s++]=fr[u],i[s++]=61,a===1&&(i[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))};var ac="invalid encoding";Wn.decode=function(e,t,n){for(var o=n,i=0,s,a=0;a<e.length;){var u=e.charCodeAt(a++);if(u===61&&i>1)break;if((u=uc[u])===void 0)throw Error(ac);switch(i){case 0:s=u,i=1;break;case 1:t[n++]=s<<2|(u&48)>>4,s=u,i=2;break;case 2:t[n++]=(s&15)<<4|(u&60)>>2,s=u,i=3;break;case 3:t[n++]=(s&3)<<6|u,i=0;break}}if(i===1)throw Error(ac);return n-o};Wn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var dc=_((Vb,lc)=>{"use strict";lc.exports=Qn;function Qn(){this._listeners={}}Qn.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};Qn.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],o=0;o<n.length;)n[o].fn===t?n.splice(o,1):++o;return this};Qn.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],o=1;o<arguments.length;)n.push(arguments[o++]);for(o=0;o<t.length;)t[o].fn.apply(t[o++].ctx,n)}return this}});var bc=_((Wb,wc)=>{"use strict";wc.exports=pc(pc);function pc(r){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function o(u,f,c){e[0]=u,f[c]=t[0],f[c+1]=t[1],f[c+2]=t[2],f[c+3]=t[3]}function i(u,f,c){e[0]=u,f[c]=t[3],f[c+1]=t[2],f[c+2]=t[1],f[c+3]=t[0]}r.writeFloatLE=n?o:i,r.writeFloatBE=n?i:o;function s(u,f){return t[0]=u[f],t[1]=u[f+1],t[2]=u[f+2],t[3]=u[f+3],e[0]}function a(u,f){return t[3]=u[f],t[2]=u[f+1],t[1]=u[f+2],t[0]=u[f+3],e[0]}r.readFloatLE=n?s:a,r.readFloatBE=n?a:s}():function(){function e(n,o,i,s){var a=o<0?1:0;if(a&&(o=-o),o===0)n(1/o>0?0:2147483648,i,s);else if(isNaN(o))n(2143289344,i,s);else if(o>34028234663852886e22)n((a<<31|2139095040)>>>0,i,s);else if(o<11754943508222875e-54)n((a<<31|Math.round(o/1401298464324817e-60))>>>0,i,s);else{var u=Math.floor(Math.log(o)/Math.LN2),f=Math.round(o*Math.pow(2,-u)*8388608)&8388607;n((a<<31|u+127<<23|f)>>>0,i,s)}}r.writeFloatLE=e.bind(null,hc),r.writeFloatBE=e.bind(null,yc);function t(n,o,i){var s=n(o,i),a=(s>>31)*2+1,u=s>>>23&255,f=s&8388607;return u===255?f?NaN:a*(1/0):u===0?a*1401298464324817e-60*f:a*Math.pow(2,u-150)*(f+8388608)}r.readFloatLE=t.bind(null,mc),r.readFloatBE=t.bind(null,gc)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function o(u,f,c){e[0]=u,f[c]=t[0],f[c+1]=t[1],f[c+2]=t[2],f[c+3]=t[3],f[c+4]=t[4],f[c+5]=t[5],f[c+6]=t[6],f[c+7]=t[7]}function i(u,f,c){e[0]=u,f[c]=t[7],f[c+1]=t[6],f[c+2]=t[5],f[c+3]=t[4],f[c+4]=t[3],f[c+5]=t[2],f[c+6]=t[1],f[c+7]=t[0]}r.writeDoubleLE=n?o:i,r.writeDoubleBE=n?i:o;function s(u,f){return t[0]=u[f],t[1]=u[f+1],t[2]=u[f+2],t[3]=u[f+3],t[4]=u[f+4],t[5]=u[f+5],t[6]=u[f+6],t[7]=u[f+7],e[0]}function a(u,f){return t[7]=u[f],t[6]=u[f+1],t[5]=u[f+2],t[4]=u[f+3],t[3]=u[f+4],t[2]=u[f+5],t[1]=u[f+6],t[0]=u[f+7],e[0]}r.readDoubleLE=n?s:a,r.readDoubleBE=n?a:s}():function(){function e(n,o,i,s,a,u){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,a,u+o),n(1/s>0?0:2147483648,a,u+i);else if(isNaN(s))n(0,a,u+o),n(2146959360,a,u+i);else if(s>17976931348623157e292)n(0,a,u+o),n((f<<31|2146435072)>>>0,a,u+i);else{var c;if(s<22250738585072014e-324)c=s/5e-324,n(c>>>0,a,u+o),n((f<<31|c/4294967296)>>>0,a,u+i);else{var l=Math.floor(Math.log(s)/Math.LN2);l===1024&&(l=1023),c=s*Math.pow(2,-l),n(c*4503599627370496>>>0,a,u+o),n((f<<31|l+1023<<20|c*1048576&1048575)>>>0,a,u+i)}}}r.writeDoubleLE=e.bind(null,hc,0,4),r.writeDoubleBE=e.bind(null,yc,4,0);function t(n,o,i,s,a){var u=n(s,a+o),f=n(s,a+i),c=(f>>31)*2+1,l=f>>>20&2047,p=4294967296*(f&1048575)+u;return l===2047?p?NaN:c*(1/0):l===0?c*5e-324*p:c*Math.pow(2,l-1075)*(p+4503599627370496)}r.readDoubleLE=t.bind(null,mc,0,4),r.readDoubleBE=t.bind(null,gc,4,0)}(),r}function hc(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function yc(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function mc(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function gc(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Dc=_((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Ec=_(vc=>{"use strict";var Oi=vc;Oi.length=function(e){for(var t=0,n=0,o=0;o<e.length;++o)n=e.charCodeAt(o),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(o+1)&64512)===56320?(++o,t+=4):t+=3;return t};Oi.read=function(e,t,n){var o=n-t;if(o<1)return"";for(var i=null,s=[],a=0,u;t<n;)u=e[t++],u<128?s[a++]=u:u>191&&u<224?s[a++]=(u&31)<<6|e[t++]&63:u>239&&u<365?(u=((u&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[a++]=55296+(u>>10),s[a++]=56320+(u&1023)):s[a++]=(u&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Oi.write=function(e,t,n){for(var o=n,i,s,a=0;a<e.length;++a)i=e.charCodeAt(a),i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(i=65536+((i&1023)<<10)+(s&1023),++a,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128);return n-o}});var xc=_((Hb,_c)=>{"use strict";_c.exports=xy;function xy(r,e,t){var n=t||8192,o=n>>>1,i=null,s=n;return function(u){if(u<1||u>o)return r(u);s+u>n&&(i=r(n),s=0);var f=e.call(i,s,s+=u);return s&7&&(s=(s|7)+1),f}}});var Ac=_((Gb,Cc)=>{"use strict";Cc.exports=Q;var qr=ht();function Q(r,e){this.lo=r>>>0,this.hi=e>>>0}var Bt=Q.zero=new Q(0,0);Bt.toNumber=function(){return 0};Bt.zzEncode=Bt.zzDecode=function(){return this};Bt.length=function(){return 1};var Cy=Q.zeroHash="\0\0\0\0\0\0\0\0";Q.fromNumber=function(e){if(e===0)return Bt;var t=e<0;t&&(e=-e);var n=e>>>0,o=(e-n)/4294967296>>>0;return t&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new Q(n,o)};Q.from=function(e){if(typeof e=="number")return Q.fromNumber(e);if(qr.isString(e))if(qr.Long)e=qr.Long.fromString(e);else return Q.fromNumber(parseInt(e,10));return e.low||e.high?new Q(e.low>>>0,e.high>>>0):Bt};Q.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};Q.prototype.toLong=function(e){return qr.Long?new qr.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var pt=String.prototype.charCodeAt;Q.fromHash=function(e){return e===Cy?Bt:new Q((pt.call(e,0)|pt.call(e,1)<<8|pt.call(e,2)<<16|pt.call(e,3)<<24)>>>0,(pt.call(e,4)|pt.call(e,5)<<8|pt.call(e,6)<<16|pt.call(e,7)<<24)>>>0)};Q.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Q.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Q.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Q.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var ht=_(Ti=>{"use strict";var v=Ti;v.asPromise=sc();v.base64=fc();v.EventEmitter=dc();v.float=bc();v.inquire=Dc();v.utf8=Ec();v.pool=xc();v.LongBits=Ac();v.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);v.global=v.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Ti;v.emptyArray=Object.freeze?Object.freeze([]):[];v.emptyObject=Object.freeze?Object.freeze({}):{};v.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};v.isString=function(e){return typeof e=="string"||e instanceof String};v.isObject=function(e){return e&&typeof e=="object"};v.isset=v.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};v.Buffer=function(){try{var r=v.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();v._Buffer_from=null;v._Buffer_allocUnsafe=null;v.newBuffer=function(e){return typeof e=="number"?v.Buffer?v._Buffer_allocUnsafe(e):new v.Array(e):v.Buffer?v._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};v.Array=typeof Uint8Array<"u"?Uint8Array:Array;v.Long=v.global.dcodeIO&&v.global.dcodeIO.Long||v.global.Long||v.inquire("long");v.key2Re=/^true|false|0|1$/;v.key32Re=/^-?(?:0|[1-9][0-9]*)$/;v.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;v.longToHash=function(e){return e?v.LongBits.from(e).toHash():v.LongBits.zeroHash};v.longFromHash=function(e,t){var n=v.LongBits.fromHash(e);return v.Long?v.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))};function Sc(r,e,t){for(var n=Object.keys(e),o=0;o<n.length;++o)(r[n[o]]===void 0||!t)&&(r[n[o]]=e[n[o]]);return r}v.merge=Sc;v.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Oc(r){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Sc(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}v.newError=Oc;v.ProtocolError=Oc("ProtocolError");v.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var o=Object.keys(this),i=o.length-1;i>-1;--i)if(t[o[i]]===1&&this[o[i]]!==void 0&&this[o[i]]!==null)return o[i]}};v.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};v.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};v._configure=function(){var r=v.Buffer;if(!r){v._Buffer_from=v._Buffer_allocUnsafe=null;return}v._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,n){return new r(t,n)},v._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var Fi=_((Yb,Pc)=>{"use strict";Pc.exports=O;var Ae=ht(),ki,Hn=Ae.LongBits,Tc=Ae.base64,kc=Ae.utf8;function Ur(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function Pi(){}function Ay(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function O(){this.len=0,this.head=new Ur(Pi,0,0),this.tail=this.head,this.states=null}var Ic=function(){return Ae.Buffer?function(){return(O.create=function(){return new ki})()}:function(){return new O}};O.create=Ic();O.alloc=function(e){return new Ae.Array(e)};Ae.Array!==Array&&(O.alloc=Ae.pool(O.alloc,Ae.Array.prototype.subarray));O.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Ur(e,t,n),this.len+=t,this};function Bi(r,e,t){e[t]=r&255}function Sy(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function Ri(r,e){this.len=r,this.next=void 0,this.val=e}Ri.prototype=Object.create(Ur.prototype);Ri.prototype.fn=Sy;O.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Ri((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};O.prototype.int32=function(e){return e<0?this._push(Ni,10,Hn.fromNumber(e)):this.uint32(e)};O.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ni(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}O.prototype.uint64=function(e){var t=Hn.from(e);return this._push(Ni,t.length(),t)};O.prototype.int64=O.prototype.uint64;O.prototype.sint64=function(e){var t=Hn.from(e).zzEncode();return this._push(Ni,t.length(),t)};O.prototype.bool=function(e){return this._push(Bi,1,e?1:0)};function Ii(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}O.prototype.fixed32=function(e){return this._push(Ii,4,e>>>0)};O.prototype.sfixed32=O.prototype.fixed32;O.prototype.fixed64=function(e){var t=Hn.from(e);return this._push(Ii,4,t.lo)._push(Ii,4,t.hi)};O.prototype.sfixed64=O.prototype.fixed64;O.prototype.float=function(e){return this._push(Ae.float.writeFloatLE,4,e)};O.prototype.double=function(e){return this._push(Ae.float.writeDoubleLE,8,e)};var Oy=Ae.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var o=0;o<e.length;++o)t[n+o]=e[o]};O.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(Bi,1,0);if(Ae.isString(e)){var n=O.alloc(t=Tc.length(e));Tc.decode(e,n,0),e=n}return this.uint32(t)._push(Oy,t,e)};O.prototype.string=function(e){var t=kc.length(e);return t?this.uint32(t)._push(kc.write,t,e):this._push(Bi,1,0)};O.prototype.fork=function(){return this.states=new Ay(this),this.head=this.tail=new Ur(Pi,0,0),this.len=0,this};O.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ur(Pi,0,0),this.len=0),this};O.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};O.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};O._configure=function(r){ki=r,O.create=Ic(),ki._configure()}});var Nc=_((Zb,Rc)=>{"use strict";Rc.exports=Qe;var Bc=Fi();(Qe.prototype=Object.create(Bc.prototype)).constructor=Qe;var yt=ht();function Qe(){Bc.call(this)}Qe._configure=function(){Qe.alloc=yt._Buffer_allocUnsafe,Qe.writeBytesBuffer=yt.Buffer&&yt.Buffer.prototype instanceof Uint8Array&&yt.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var o=0;o<e.length;)t[n++]=e[o++]}};Qe.prototype.bytes=function(e){yt.isString(e)&&(e=yt._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Qe.writeBytesBuffer,t,e),this};function Ty(r,e,t){r.length<40?yt.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}Qe.prototype.string=function(e){var t=yt.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Ty,t,e),this};Qe._configure()});var Mi=_((Xb,jc)=>{"use strict";jc.exports=j;var He=ht(),$i,$c=He.LongBits,ky=He.utf8;function Re(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function j(r){this.buf=r,this.pos=0,this.len=r.length}var Fc=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new j(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new j(e);throw Error("illegal buffer")},Mc=function(){return He.Buffer?function(t){return(j.create=function(o){return He.Buffer.isBuffer(o)?new $i(o):Fc(o)})(t)}:Fc};j.create=Mc();j.prototype._slice=He.Array.prototype.subarray||He.Array.prototype.slice;j.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Re(this,10);return e}}();j.prototype.int32=function(){return this.uint32()|0};j.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Li(){var r=new $c(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Re(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw Re(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}j.prototype.bool=function(){return this.uint32()!==0};function Gn(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}j.prototype.fixed32=function(){if(this.pos+4>this.len)throw Re(this,4);return Gn(this.buf,this.pos+=4)};j.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Re(this,4);return Gn(this.buf,this.pos+=4)|0};function Lc(){if(this.pos+8>this.len)throw Re(this,8);return new $c(Gn(this.buf,this.pos+=4),Gn(this.buf,this.pos+=4))}j.prototype.float=function(){if(this.pos+4>this.len)throw Re(this,4);var e=He.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};j.prototype.double=function(){if(this.pos+8>this.len)throw Re(this,4);var e=He.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};j.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw Re(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};j.prototype.string=function(){var e=this.bytes();return ky.read(e,0,e.length)};j.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Re(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Re(this);while(this.buf[this.pos++]&128);return this};j.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};j._configure=function(r){$i=r,j.create=Mc(),$i._configure();var e=He.Long?"toLong":"toNumber";He.merge(j.prototype,{int64:function(){return Li.call(this)[e](!1)},uint64:function(){return Li.call(this)[e](!0)},sint64:function(){return Li.call(this).zzDecode()[e](!1)},fixed64:function(){return Lc.call(this)[e](!0)},sfixed64:function(){return Lc.call(this)[e](!1)}})}});var Kc=_((e0,zc)=>{"use strict";zc.exports=Rt;var Uc=Mi();(Rt.prototype=Object.create(Uc.prototype)).constructor=Rt;var qc=ht();function Rt(r){Uc.call(this,r)}Rt._configure=function(){qc.Buffer&&(Rt.prototype._slice=qc.Buffer.prototype.slice)};Rt.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Rt._configure()});var Wc=_((t0,Vc)=>{"use strict";Vc.exports=zr;var ji=ht();(zr.prototype=Object.create(ji.EventEmitter.prototype)).constructor=zr;function zr(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");ji.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}zr.prototype.rpcCall=function r(e,t,n,o,i){if(!o)throw TypeError("request must be specified");var s=this;if(!i)return ji.asPromise(r,s,e,t,n,o);if(!s.rpcImpl){setTimeout(function(){i(Error("already ended"))},0);return}try{return s.rpcImpl(e,t[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(u,f){if(u)return s.emit("error",u,e),i(u);if(f===null){s.end(!0);return}if(!(f instanceof n))try{f=n[s.responseDelimited?"decodeDelimited":"decode"](f)}catch(c){return s.emit("error",c,e),i(c)}return s.emit("data",f,e),i(null,f)})}catch(a){s.emit("error",a,e),setTimeout(function(){i(a)},0);return}};zr.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Hc=_(Qc=>{"use strict";var Iy=Qc;Iy.Service=Wc()});var Jc=_((n0,Gc)=>{"use strict";Gc.exports={}});var Xc=_(Zc=>{"use strict";var oe=Zc;oe.build="minimal";oe.Writer=Fi();oe.BufferWriter=Nc();oe.Reader=Mi();oe.BufferReader=Kc();oe.util=ht();oe.rpc=Hc();oe.roots=Jc();oe.configure=Yc;function Yc(){oe.util._configure(),oe.Writer._configure(oe.BufferWriter),oe.Reader._configure(oe.BufferReader)}Yc()});var mt=_((i0,ef)=>{"use strict";ef.exports=Xc()});var of=_((qi,nf)=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});Yn.BASE=2166136261;function Yn(r,e=Yn.BASE){let t=r.length;for(let n=0;n<t;n++)e^=r.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}qi.default=Yn;nf.exports=Yn});var uf=_((u0,af)=>{af.exports=Ui;var sf=128,By=127,Ry=~By,Ny=Math.pow(2,31);function Ui(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw Ui.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var n=t;r>=Ny;)e[t++]=r&255|sf,r/=128;for(;r&Ry;)e[t++]=r&255|sf,r>>>=7;return e[t]=r|0,Ui.bytes=t-n+1,e}});var lf=_((c0,ff)=>{ff.exports=zi;var Fy=128,cf=127;function zi(r,n){var t=0,n=n||0,o=0,i=n,s,a=r.length;do{if(i>=a||o>49)throw zi.bytes=0,new RangeError("Could not decode varint");s=r[i++],t+=o<28?(s&cf)<<o:(s&cf)*Math.pow(2,o),o+=7}while(s>=Fy);return zi.bytes=i-n,t}});var pf=_((f0,df)=>{var Ly=Math.pow(2,7),$y=Math.pow(2,14),My=Math.pow(2,21),jy=Math.pow(2,28),qy=Math.pow(2,35),Uy=Math.pow(2,42),zy=Math.pow(2,49),Ky=Math.pow(2,56),Vy=Math.pow(2,63);df.exports=function(r){return r<Ly?1:r<$y?2:r<My?3:r<jy?4:r<qy?5:r<Uy?6:r<zy?7:r<Ky?8:r<Vy?9:10}});var Kr=_((l0,hf)=>{hf.exports={encode:uf(),decode:lf(),encodingLength:pf()}});var Wi={};z(Wi,{concat:()=>Wr});function Wr(r,e){e||(e=r.reduce((o,i)=>o+i.length,0));let t=Pn(e),n=0;for(let o of r)t.set(o,n),n+=o.length;return t}var Xn=k(()=>{hi()});var Nf=_((H0,Rf)=>{"use strict";var Bf="[a-fA-F\\d:]",bt=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${Bf})|(?<=${Bf})(?=\\s|$))`:"",Fe="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",V="[a-fA-F\\d]{1,4}",so=`
(?:
(?:${V}:){7}(?:${V}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${V}:){6}(?:${Fe}|:${V}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${V}:){5}(?::${Fe}|(?::${V}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${V}:){4}(?:(?::${V}){0,1}:${Fe}|(?::${V}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${V}:){3}(?:(?::${V}){0,2}:${Fe}|(?::${V}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${V}:){2}(?:(?::${V}){0,3}:${Fe}|(?::${V}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${V}:){1}(?:(?::${V}){0,4}:${Fe}|(?::${V}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${V}){0,5}:${Fe}|(?::${V}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),am=new RegExp(`(?:^${Fe}$)|(?:^${so}$)`),um=new RegExp(`^${Fe}$`),cm=new RegExp(`^${so}$`),ts=r=>r&&r.exact?am:new RegExp(`(?:${bt(r)}${Fe}${bt(r)})|(?:${bt(r)}${so}${bt(r)})`,"g");ts.v4=r=>r&&r.exact?um:new RegExp(`${bt(r)}${Fe}${bt(r)}`,"g");ts.v6=r=>r&&r.exact?cm:new RegExp(`${bt(r)}${so}${bt(r)}`,"g");Rf.exports=ts});var Lf=_((G0,Ff)=>{"use strict";var rs=Nf(),pr=r=>rs({exact:!0}).test(r);pr.v4=r=>rs.v4({exact:!0}).test(r);pr.v6=r=>rs.v6({exact:!0}).test(r);pr.version=r=>pr(r)?pr.v4(r)?4:6:void 0;Ff.exports=pr});var Uf=_((J0,qf)=>{"use strict";var os=Lf(),{toString:$f}=(_e(),te(Ir)),fm=os,ns=os.v4,Mf=os.v6,jf=function(r,e,t){t=~~t;let n;if(ns(r))n=e||new Uint8Array(t+4),r.split(/\./g).map(function(o){n[t++]=parseInt(o,10)&255});else if(Mf(r)){let o=r.split(":",8),i;for(i=0;i<o.length;i++){let s=ns(o[i]),a;s&&(a=jf(o[i]),o[i]=$f(a.slice(0,2),"base16")),a&&++i<8&&o.splice(i,0,$f(a.slice(2,4),"base16"))}if(o[0]==="")for(;o.length<8;)o.unshift("0");else if(o[o.length-1]==="")for(;o.length<8;)o.push("0");else if(o.length<8){for(i=0;i<o.length&&o[i]!=="";i++);let s=[i,"1"];for(i=9-o.length;i>0;i--)s.push("0");o.splice.apply(o,s)}for(n=e||new Uint8Array(t+16),i=0;i<o.length;i++){let s=parseInt(o[i],16);n[t++]=s>>8&255,n[t++]=s&255}}if(!n)throw Error("Invalid ip address: "+r);return n},lm=function(r,e,t){e=~~e,t=t||r.length-e;let n=[],o,i=new DataView(r.buffer);if(t===4){for(let s=0;s<t;s++)n.push(r[e+s]);o=n.join(".")}else if(t===16){for(let s=0;s<t;s+=2)n.push(i.getUint16(e+s).toString(16));o=n.join(":"),o=o.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),o=o.replace(/:{3,4}/,"::")}return o};qf.exports={isIP:fm,isV4:ns,isV6:Mf,toBytes:jf,toString:lm}});var ao=_((Y0,Kf)=>{"use strict";function ie(r){if(typeof r=="number"){if(ie.codes[r])return ie.codes[r];throw new Error("no protocol with code: "+r)}else if(typeof r=="string"){if(ie.names[r])return ie.names[r];throw new Error("no protocol with name: "+r)}throw new Error("invalid protocol id type: "+r)}var Se=-1;ie.lengthPrefixedVarSize=Se;ie.V=Se;ie.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Se,"ip6zone"],[53,Se,"dns","resolvable"],[54,Se,"dns4","resolvable"],[55,Se,"dns6","resolvable"],[56,Se,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Se,"unix",!1,"path"],[421,Se,"ipfs"],[421,Se,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Se,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Se,"memory"]];ie.names={};ie.codes={};ie.table.map(r=>{let e=zf.apply(null,r);return ie.codes[e.code]=e,ie.names[e.name]=e,null});ie.object=zf;function zf(r,e,t,n,o){return{code:r,size:e,name:t,resolvable:Boolean(n),path:Boolean(o)}}Kf.exports=ie});var Zf=_((Z0,Yf)=>{"use strict";var uo=Uf(),Qf=ao(),{CID:dm}=(fe(),te(Go)),{base32:Hf}=(et(),te(Cn)),{base58btc:pm}=(Tr(),te(Or)),hm=(Xe(),te(Ue)),hr=Kr(),{toString:co}=(_e(),te(Ir)),{fromString:Gf}=(Ke(),te($a)),{concat:fo}=(Xn(),te(Wi));Yf.exports=Yr;function Yr(r,e){return e instanceof Uint8Array?Yr.toString(r,e):Yr.toBytes(r,e)}Yr.toString=function(e,t){switch(Qf(e).code){case 4:case 41:return ym(t);case 6:case 273:case 33:case 132:return Jf(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return gm(t);case 421:return bm(t);case 444:return Wf(t);case 445:return Wf(t);default:return co(t,"base16")}};Yr.toBytes=function(e,t){switch(Qf(e).code){case 4:return Vf(t);case 41:return Vf(t);case 6:case 273:case 33:case 132:return is(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return mm(t);case 421:return wm(t);case 444:return Dm(t);case 445:return vm(t);default:return Gf(t,"base16")}};function Vf(r){if(!uo.isIP(r))throw new Error("invalid ip address");return uo.toBytes(r)}function ym(r){let e=uo.toString(r);if(!e||!uo.isIP(e))throw new Error("invalid ip address");return e}function is(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function Jf(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function mm(r){let e=Gf(r),t=Uint8Array.from(hr.encode(e.length));return fo([t,e],t.length+e.length)}function gm(r){let e=hr.decode(r);if(r=r.slice(hr.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return co(r)}function wm(r){let e;r[0]==="Q"||r[0]==="1"?e=hm.decode(pm.decode(`z${r}`)).bytes:e=dm.parse(r).multihash.bytes;let t=Uint8Array.from(hr.encode(e.length));return fo([t,e],t.length+e.length)}function bm(r){let e=hr.decode(r),t=r.slice(hr.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return co(t,"base58btc")}function Dm(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let t=Hf.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=is(n);return fo([t,o],t.length+o.length)}function vm(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let t=Hf.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=is(n);return fo([t,o],t.length+o.length)}function Wf(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),n=co(e,"base32"),o=Jf(t);return n+":"+o}});var fl=_((X0,cl)=>{"use strict";var el=Zf(),ss=ao(),Zr=Kr(),{concat:Xf}=(Xn(),te(Wi)),{toString:Em}=(_e(),te(Ir));cl.exports={stringToStringTuples:tl,stringTuplesToString:rl,tuplesToStringTuples:ol,stringTuplesToTuples:nl,bytesToTuples:as,tuplesToBytes:il,bytesToString:_m,stringToBytes:al,fromString:xm,fromBytes:ul,validateBytes:us,isValidBytes:Cm,cleanPath:lo,ParseError:cs,protoFromTuple:Xr,sizeForAddr:sl};function tl(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let n=0;n<t.length;n++){let o=t[n],i=ss(o);if(i.size===0){e.push([o]);continue}if(n++,n>=t.length)throw cs("invalid address: "+r);if(i.path){e.push([o,lo(t.slice(n).join("/"))]);break}e.push([o,t[n]])}return e}function rl(r){let e=[];return r.map(t=>{let n=Xr(t);return e.push(n.name),t.length>1&&e.push(t[1]),null}),lo(e.join("/"))}function nl(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=Xr(e);return e.length>1?[t.code,el.toBytes(t.code,e[1])]:[t.code]})}function ol(r){return r.map(e=>{let t=Xr(e);return e[1]?[t.code,el.toString(t.code,e[1])]:[t.code]})}function il(r){return ul(Xf(r.map(e=>{let t=Xr(e),n=Uint8Array.from(Zr.encode(t.code));return e.length>1&&(n=Xf([n,e[1]])),n})))}function sl(r,e){return r.size>0?r.size/8:r.size===0?0:Zr.decode(e)+Zr.decode.bytes}function as(r){let e=[],t=0;for(;t<r.length;){let n=Zr.decode(r,t),o=Zr.decode.bytes,i=ss(n),s=sl(i,r.slice(t+o));if(s===0){e.push([n]),t+=o;continue}let a=r.slice(t+o,t+o+s);if(t+=s+o,t>r.length)throw cs("Invalid address Uint8Array: "+Em(r,"base16"));e.push([n,a])}return e}function _m(r){let e=as(r),t=ol(e);return rl(t)}function al(r){r=lo(r);let e=tl(r),t=nl(e);return il(t)}function xm(r){return al(r)}function ul(r){let e=us(r);if(e)throw e;return Uint8Array.from(r)}function us(r){try{as(r)}catch(e){return e}}function Cm(r){return us(r)===void 0}function lo(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function cs(r){return new Error("Error parsing address: "+r)}function Xr(r){return ss(r[0])}});var ll={};z(ll,{equals:()=>Am});function Am(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var dl=k(()=>{});var ml=_((e1,yl)=>{"use strict";var Le=fl(),yr=ao(),pl=Kr(),{CID:Sm}=(fe(),te(Go)),{base58btc:Om}=(Tr(),te(Or)),Tm=Je(),km=Symbol.for("nodejs.util.inspect.custom"),{toString:po}=(_e(),te(Ir)),{equals:Im}=(dl(),te(ll)),fs=new Map,hl=Symbol.for("@multiformats/js-multiaddr/multiaddr"),X=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,hl,{value:!0}),e instanceof Uint8Array)this.bytes=Le.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Le.fromString(e)}else if(X.isMultiaddr(e))this.bytes=Le.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Le.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},t=this.toString().split("/");return e.family=t[1]==="ip4"?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},yr(e)))}protoCodes(){let e=[],t=this.bytes,n=0;for(;n<t.length;){let o=pl.decode(t,n),i=pl.decode.bytes,s=yr(o);n+=Le.sizeForAddr(s,t.slice(n+i))+i,e.push(o)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Le.bytesToTuples(this.bytes)}stringTuples(){let e=Le.bytesToTuples(this.bytes);return Le.tuplesToStringTuples(e)}encapsulate(e){return e=new X(e),new X(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),n=this.toString(),o=n.lastIndexOf(t);if(o<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new X(n.slice(0,o))}decapsulateCode(e){let t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new X(Le.tuplesToBytes(t.slice(0,n)));return this}getPeerId(){try{let t=this.stringTuples().filter(n=>n[0]===yr.names.ipfs.code).pop();if(t&&t[1]){let n=t[1];return n[0]==="Q"||n[0]==="1"?po(Om.decode(`z${n}`),"base58btc"):po(Sm.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!!yr(t[0]).path)[0][1],e||(e=null)}catch{e=null}return e}equals(e){return Im(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(o=>o.resolvable);if(!e)return[this];let t=fs.get(e.name);if(!t)throw Tm(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(o=>new X(o))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let t=(e||this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new X("/"+[n,e.address,t,e.port].join("/"))}static isName(e){return X.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return e instanceof X||Boolean(e&&e[hl])}[km](){return"<Multiaddr "+po(this.bytes,"base16")+" - "+Le.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+po(this.bytes,"base16")+" - "+Le.bytesToString(this.bytes)+">"}};X.protocols=yr;X.resolvers=fs;function Pm(r){return new X(r)}yl.exports={Multiaddr:X,multiaddr:Pm,protocols:yr,resolvers:fs}});var Al=_((x1,yo)=>{"use strict";yo.exports=qm;yo.exports.format=xl;yo.exports.parse=Cl;var $m=/\B(?=(\d{3})+(?!\d))/g,Mm=/(?:\.0*|(\.[^0]+)0+)$/,vt={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},jm=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function qm(r,e){return typeof r=="string"?Cl(r):typeof r=="number"?xl(r,e):null}function xl(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),n=e&&e.thousandsSeparator||"",o=e&&e.unitSeparator||"",i=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,s=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!vt[a.toLowerCase()])&&(t>=vt.pb?a="PB":t>=vt.tb?a="TB":t>=vt.gb?a="GB":t>=vt.mb?a="MB":t>=vt.kb?a="KB":a="B");var u=r/vt[a.toLowerCase()],f=u.toFixed(i);return s||(f=f.replace(Mm,"$1")),n&&(f=f.split(".").map(function(c,l){return l===0?c.replace($m,n):c}).join(".")),f+o+a}function Cl(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=jm.exec(r),t,n="b";return e?(t=parseFloat(e[1]),n=e[4].toLowerCase()):(t=parseInt(r,10),n="b"),isNaN(t)?null:Math.floor(vt[n]*t)}});var Ol=_((C1,Sl)=>{"use strict";Sl.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var Rl=_((Pl,Bl)=>{"use strict";var mo=Ol(),{hasOwnProperty:kl}=Object.prototype,{propertyIsEnumerable:Um}=Object,br=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),zm=Pl,Tl={concatArrays:!1,ignoreUndefined:!1},go=r=>{let e=[];for(let t in r)kl.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let n of t)Um.call(r,n)&&e.push(n)}return e};function Dr(r){return Array.isArray(r)?Km(r):mo(r)?Vm(r):r}function Km(r){let e=r.slice(0,0);return go(r).forEach(t=>{br(e,t,Dr(r[t]))}),e}function Vm(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return go(r).forEach(t=>{br(e,t,Dr(r[t]))}),e}var Il=(r,e,t,n)=>(t.forEach(o=>{typeof e[o]>"u"&&n.ignoreUndefined||(o in r&&r[o]!==Object.getPrototypeOf(r)?br(r,o,ms(r[o],e[o],n)):br(r,o,Dr(e[o])))}),r),Wm=(r,e,t)=>{let n=r.slice(0,0),o=0;return[r,e].forEach(i=>{let s=[];for(let a=0;a<i.length;a++)!kl.call(i,a)||(s.push(String(a)),i===r?br(n,o++,i[a]):br(n,o++,Dr(i[a])));n=Il(n,i,go(i).filter(a=>!s.includes(a)),t)}),n};function ms(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?Wm(r,e,t):!mo(e)||!mo(r)?Dr(e):Il(r,e,go(e),t)}Bl.exports=function(...r){let e=ms(Dr(Tl),this!==zm&&this||{},Tl),t={_:{}};for(let n of r)if(n!==void 0){if(!mo(n))throw new TypeError("`"+n+"` is not an Option Object");t=ms(t,{_:n},e)}return t._}});var bs=_((R1,ws)=>{"use strict";var Jm=Object.prototype.hasOwnProperty,ne="~";function rn(){}Object.create&&(rn.prototype=Object.create(null),new rn().__proto__||(ne=!1));function Ym(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function Ul(r,e,t,n,o){if(typeof t!="function")throw new TypeError("The listener must be a function");var i=new Ym(t,n||r,o),s=ne?ne+e:e;return r._events[s]?r._events[s].fn?r._events[s]=[r._events[s],i]:r._events[s].push(i):(r._events[s]=i,r._eventsCount++),r}function Do(r,e){--r._eventsCount===0?r._events=new rn:delete r._events[e]}function ee(){this._events=new rn,this._eventsCount=0}ee.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)Jm.call(t,n)&&e.push(ne?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};ee.prototype.listeners=function(e){var t=ne?ne+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,s=new Array(i);o<i;o++)s[o]=n[o].fn;return s};ee.prototype.listenerCount=function(e){var t=ne?ne+e:e,n=this._events[t];return n?n.fn?1:n.length:0};ee.prototype.emit=function(e,t,n,o,i,s){var a=ne?ne+e:e;if(!this._events[a])return!1;var u=this._events[a],f=arguments.length,c,l;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,o),!0;case 5:return u.fn.call(u.context,t,n,o,i),!0;case 6:return u.fn.call(u.context,t,n,o,i,s),!0}for(l=1,c=new Array(f-1);l<f;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var p=u.length,D;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),f){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,o);break;default:if(!c)for(D=1,c=new Array(f-1);D<f;D++)c[D-1]=arguments[D];u[l].fn.apply(u[l].context,c)}}return!0};ee.prototype.on=function(e,t,n){return Ul(this,e,t,n,!1)};ee.prototype.once=function(e,t,n){return Ul(this,e,t,n,!0)};ee.prototype.removeListener=function(e,t,n,o){var i=ne?ne+e:e;if(!this._events[i])return this;if(!t)return Do(this,i),this;var s=this._events[i];if(s.fn)s.fn===t&&(!o||s.once)&&(!n||s.context===n)&&Do(this,i);else{for(var a=0,u=[],f=s.length;a<f;a++)(s[a].fn!==t||o&&!s[a].once||n&&s[a].context!==n)&&u.push(s[a]);u.length?this._events[i]=u.length===1?u[0]:u:Do(this,i)}return this};ee.prototype.removeAllListeners=function(e){var t;return e?(t=ne?ne+e:e,this._events[t]&&Do(this,t)):(this._events=new rn,this._eventsCount=0),this};ee.prototype.off=ee.prototype.removeListener;ee.prototype.addListener=ee.prototype.on;ee.prefixed=ne;ee.EventEmitter=ee;typeof ws<"u"&&(ws.exports=ee)});var Ts=_((lD,nd)=>{"use strict";var tg=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};nd.exports=tg});var id=_((yD,od)=>{"use strict";var ng=async r=>{for await(let e of r);};od.exports=ng});var md=_((CD,yd)=>{"use strict";var sg=async r=>{for await(let e of r)return e};yd.exports=sg});var Fs=_((qD,vd)=>{"use strict";var fg=async function*(r,e){for await(let t of r)yield e(t)};vd.exports=fg});var Ld=_((sv,Fd)=>{"use strict";async function*yg(r,e=1){let t=[];e<1&&(e=1);for await(let n of r)for(t.push(n);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}Fd.exports=yg});var Md=_((av,$d)=>{"use strict";var mg=Ld();async function*gg(r,e=1){for await(let t of mg(r,e)){let n=t.map(o=>o().then(i=>({ok:!0,value:i}),i=>({ok:!1,err:i})));for(let o=0;o<n.length;o++){let i=await n[o];if(i.ok)yield i.value;else throw i.err}}}$d.exports=gg});var qd=_((cv,jd)=>{jd.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var Kd=_((lv,zd)=>{var Ud=qd();zd.exports=class{constructor(e){this.hwm=e||16,this.head=new Ud(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new Ud(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var Wd=_((dv,Vd)=>{var Js=Kd();Vd.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new Js,n,o,i,s=()=>{if(!t.isEmpty()){if(r.writev){let g,S=[];for(;!t.isEmpty();){if(g=t.shift(),g.error)throw g.error;S.push(g.value)}return{done:g.done,value:S}}let h=t.shift();if(h.error)throw h.error;return h}return i?{done:!0}:new Promise((h,g)=>{o=S=>(o=null,S.error?g(S.error):r.writev&&!S.done?h({done:S.done,value:[S.value]}):h(S),n)})},a=h=>o?o(h):(t.push(h),n),u=h=>(t=new Js,o?o({error:h}):(t.push({error:h}),n)),f=h=>i?n:a({done:!1,value:h}),c=h=>i?n:(i=!0,h?u(h):a({done:!0})),l=()=>(t=new Js,c(),{done:!0}),p=h=>(c(h),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:l,throw:p,push:f,end:c},!e)return n;let D=n;return n={[Symbol.asyncIterator](){return this},next(){return D.next()},throw(h){return D.throw(h),e&&(e(h),e=null),{done:!0}},return(){return D.return(),e&&(e(),e=null),{done:!0}},push:f,end(h){return D.end(h),e&&(e(h),e=null),n}},n}});var Ys=_((pv,Qd)=>{"use strict";var wg=Wd(),bg=async function*(...r){let e=wg();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let n of t)e.push(n)})),e.end()}catch(t){e.end(t)}},0),yield*e};Qd.exports=bg});var Pg={};z(Pg,{createRepo:()=>Tg});var Cr=cp;function cp(r,e,t){if(!r)return t;var n,o;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;)if(o=n.shift(),!r||(r=r[o],r===void 0))return t;return r}var rp=A(qe(),1),Ht=A(Je(),1);fe();var On=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");_e();Ke();var tt="/",Ma=new TextEncoder().encode(tt),Rn=Ma[0],x=class{constructor(e,t){if(typeof e=="string")this._buf=Y(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Rn)throw new Error("Invalid key")}toString(e="utf8"){return re(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new x(e.join(tt))}static random(){return new x(On().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new x(e):typeof e.uint8Array=="function"?new x(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Ma),this._buf[0]!==Rn){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Rn,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Rn;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let o=0;o<t.length;o++){if(n.length<o+1)return!1;let i=t[o],s=n[o];if(i<s)return!0;if(i>s)return!1}return t.length<n.length}reverse(){return x.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(tt).slice(1)}type(){return kh(this.baseNamespace())}name(){return Ih(this.baseNamespace())}instance(e){return new x(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(tt)||(e+=tt),e+=this.type(),new x(e)}parent(){let e=this.list();return e.length===1?new x(tt):new x(e.slice(0,-1).join(tt))}child(e){return this.toString()===tt?e:e.toString()===tt?this:new x(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return x.withNamespaces([...this.namespaces(),...Ph(e.map(t=>t.namespaces()))])}};function kh(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Ih(r){let e=r.split(":");return e[e.length-1]}function Ph(r){return[].concat(...r)}var Ua=A(qe(),1),za=A(gi(),1);et();kn();Xe();var Rh=(0,Ua.default)("ipfs:repo:migrator:migration-8");function Ka(r){return r.child?Ka(r.child):r}function Nh(r){try{let e=M.decode(`b${r.toString().toLowerCase().slice(1)}`),t=E.decode(e).multihash.bytes,n=M.encode(t).slice(1).toUpperCase();return new x(`/${n}`,!1)}catch{return r}}function Fh(r){try{let e=M.decode(`b${r.toString().toLowerCase().slice(1)}`),t=Ze(e),n=M.encode(E.createV1(li,t).bytes).slice(1);return new x(`/${n.toUpperCase()}`,!1)}catch{return r}}async function qa(r,e,t){let n=r.blocks;await n.open();let o=Ka(n),i=await(0,za.default)(o.queryKeys({filters:[s=>t(s).toString()!==s.toString()]}));try{let s=0;for await(let a of o.query({})){let u=t(a.key);u.toString()!==a.key.toString()&&(s+=1,Rh(`Migrating Block from ${a.key} to ${u}`,await o.has(a.key)),await o.delete(a.key),await o.put(u,a.value),e(s/i*100,`Migrated Block from ${a.key} to ${u}`))}}finally{await n.close()}}var Va={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=()=>{})=>qa(r,e,Nh),revert:(r,e=()=>{})=>qa(r,e,Fh)};fe();fe();var Lh=new TextDecoder;function wi(r,e){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let o=r[e++];if(t+=n<28?(o&127)<<n:(o&127)*2**n,o<128)break}return[t,e]}function Nn(r,e){let t;[t,e]=wi(r,e);let n=e+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,n),n]}function Wa(r,e){let t;return[t,e]=wi(r,e),[t&7,t>>3,e]}function $h(r){let e={},t=r.length,n=0;for(;n<t;){let o,i;if([o,i,n]=Wa(r,n),i===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Nn(r,n)}else if(i===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Nn(r,n),e.Name=Lh.decode(s)}else if(i===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[e.Tsize,n]=wi(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function Qa(r){let e=r.length,t=0,n,o=!1,i;for(;t<e;){let a,u;if([a,u,t]=Wa(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(u===1){if(i)throw new Error("protobuf: (PBNode) duplicate Data section");[i,t]=Nn(r,t),n&&(o=!0)}else if(u===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let f;[f,t]=Nn(r,t),n.push($h(f))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${u}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return i&&(s.Data=i),s.Links=n||[],s}var Ga=new TextEncoder,Ha=2**32,Mh=2**31;function jh(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=Pr(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){let n=Ga.encode(r.Name);t-=n.length,e.set(n,t),t=Pr(e,t,n.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=Pr(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function Ja(r){let e=Uh(r),t=new Uint8Array(e),n=e;if(r.Data&&(n-=r.Data.length,t.set(r.Data,n),n=Pr(t,n,r.Data.length)-1,t[n]=10),r.Links)for(let o=r.Links.length-1;o>=0;o--){let i=jh(r.Links[o],t.subarray(0,n));n-=i,n=Pr(t,n,i)-1,t[n]=18}return t}function qh(r){let e=0;if(r.Hash){let t=r.Hash.length;e+=1+t+nr(t)}if(typeof r.Name=="string"){let t=Ga.encode(r.Name).length;e+=1+t+nr(t)}return typeof r.Tsize=="number"&&(e+=1+nr(r.Tsize)),e}function Uh(r){let e=0;if(r.Data){let t=r.Data.length;e+=1+t+nr(t)}if(r.Links)for(let t of r.Links){let n=qh(t);e+=1+n+nr(n)}return e}function Pr(r,e,t){e-=nr(t);let n=e;for(;t>=Mh;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,n}function nr(r){return r%2===0&&r++,Math.floor((zh(r)+6)/7)}function zh(r){let e=0;return r>=Ha&&(r=Math.floor(r/Ha),e=32),r>=1<<16&&(r>>>=16,e+=16),r>=1<<8&&(r>>>=8,e+=8),e+Kh[r]}var Kh=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];fe();var Vh=["Data","Links"],Wh=["Hash","Name","Tsize"],Ya=new TextEncoder;function Qh(r,e){if(r===e)return 0;let t=r.Name?Ya.encode(r.Name):[],n=e.Name?Ya.encode(e.Name):[],o=t.length,i=n.length;for(let s=0,a=Math.min(o,i);s<a;++s)if(t[s]!==n[s]){o=t[s],i=n[s];break}return o<i?-1:i<o?1:0}function Za(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function Xa(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!Za(r,Vh))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){let t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!Za(t,Wh))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&Qh(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}var rt=112;function Br(r){Xa(r);let e={};return r.Links&&(e.Links=r.Links.map(t=>{let n={};return t.Hash&&(n.Hash=t.Hash.bytes),t.Name!==void 0&&(n.Name=t.Name),t.Tsize!==void 0&&(n.Tsize=t.Tsize),n})),r.Data&&(e.Data=r.Data),Ja(e)}function Rr(r){let e=Qa(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(n=>{let o={};try{o.Hash=E.decode(n.Hash)}catch{}if(!o.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(o.Name=n.Name),n.Tsize!==void 0&&(o.Tsize=n.Tsize),o})),t}var Hh=["string","number","bigint","symbol"],Gh=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function eu(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(Hh.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(Jh(r))return"Buffer";let t=Yh(r);return t||"Object"}function Jh(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function Yh(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(Gh.includes(e))return e}var d=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};d.uint=new d(0,"uint",!0);d.negint=new d(1,"negint",!0);d.bytes=new d(2,"bytes",!0);d.string=new d(3,"string",!0);d.array=new d(4,"array",!1);d.map=new d(5,"map",!1);d.tag=new d(6,"tag",!1);d.float=new d(7,"float",!0);d.false=new d(7,"false",!0);d.true=new d(7,"true",!0);d.null=new d(7,"null",!0);d.undefined=new d(7,"undefined",!0);d.break=new d(7,"break",!0);var m=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var or=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Zh=new TextDecoder,Xh=new TextEncoder;function Fn(r){return or&&globalThis.Buffer.isBuffer(r)}function Di(r){return r instanceof Uint8Array?Fn(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}var ou=or?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):ru(r,e,t):(r,e,t)=>t-e>64?Zh.decode(r.subarray(e,t)):ru(r,e,t),iu=or?r=>r.length>64?globalThis.Buffer.from(r):tu(r):r=>r.length>64?Xh.encode(r):tu(r),Ve=r=>Uint8Array.from(r),ir=or?(r,e,t)=>Fn(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),su=or?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Di(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),n=0;for(let o of r)n+o.length>t.length&&(o=o.subarray(0,t.length-n)),t.set(o,n),n+=o.length;return t},au=or?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function uu(r,e){if(Fn(r)&&Fn(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function tu(r,e=1/0){let t,n=r.length,o=null,i=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!o){if(t>56319){(e-=3)>-1&&i.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=t;continue}if(t<56320){(e-=3)>-1&&i.push(239,191,189),o=t;continue}t=(o-55296<<10|t-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,t<128){if((e-=1)<0)break;i.push(t)}else if(t<2048){if((e-=2)<0)break;i.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;i.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;i.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return i}function ru(r,e,t){let n=[];for(;e<t;){let o=r[e],i=null,s=o>239?4:o>223?3:o>191?2:1;if(e+s<=t){let a,u,f,c;switch(s){case 1:o<128&&(i=o);break;case 2:a=r[e+1],(a&192)===128&&(c=(o&31)<<6|a&63,c>127&&(i=c));break;case 3:a=r[e+1],u=r[e+2],(a&192)===128&&(u&192)===128&&(c=(o&15)<<12|(a&63)<<6|u&63,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:a=r[e+1],u=r[e+2],f=r[e+3],(a&192)===128&&(u&192)===128&&(f&192)===128&&(c=(o&15)<<18|(a&63)<<12|(u&63)<<6|f&63,c>65535&&c<1114112&&(i=c))}}i===null?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|i&1023),n.push(i),e+=s}return ey(n)}var nu=4096;function ey(r){let e=r.length;if(e<=nu)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=nu));return t}var ty=256,Nr=class{constructor(e=ty){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let o=t.length-(this.maxCursor-this.cursor)-1;t.set(e,o)}else{if(t){let o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=au(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=ir(n,0,this.cursor)}else t=su(this.chunks,this.cursor);return e&&this.reset(),t}};var C="CBOR decode error:",vi="CBOR encode error:",Fr=[];Fr[23]=1;Fr[24]=2;Fr[25]=3;Fr[26]=5;Fr[27]=9;function nt(r,e,t){if(r.length-e<t)throw new Error(`${C} not enough data for type`)}var W=[24,256,65536,4294967296,BigInt("18446744073709551616")];function le(r,e,t){nt(r,e,1);let n=r[e];if(t.strict===!0&&n<W[0])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function de(r,e,t){nt(r,e,2);let n=r[e]<<8|r[e+1];if(t.strict===!0&&n<W[1])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function pe(r,e,t){nt(r,e,4);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&n<W[2])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function he(r,e,t){nt(r,e,8);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],o=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(t.strict===!0&&i<W[3])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(t.allowBigInt===!0)return i;throw new Error(`${C} integers outside of the safe integer range are not supported`)}function cu(r,e,t,n){return new m(d.uint,le(r,e+1,n),2)}function fu(r,e,t,n){return new m(d.uint,de(r,e+1,n),3)}function lu(r,e,t,n){return new m(d.uint,pe(r,e+1,n),5)}function du(r,e,t,n){return new m(d.uint,he(r,e+1,n),9)}function xe(r,e){return Z(r,0,e.value)}function Z(r,e,t){if(t<W[0]){let n=Number(t);r.push([e|n])}else if(t<W[1]){let n=Number(t);r.push([e|24,n])}else if(t<W[2]){let n=Number(t);r.push([e|25,n>>>8,n&255])}else if(t<W[3]){let n=Number(t);r.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<W[4]){let o=[e|27,0,0,0,0,0,0,0],i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=s&255,s=s>>8,o[3]=s&255,s=s>>8,o[2]=s&255,s=s>>8,o[1]=s&255,r.push(o)}else throw new Error(`${C} encountered BigInt larger than allowable range`)}}xe.encodedSize=function(e){return Z.encodedSize(e.value)};Z.encodedSize=function(e){return e<W[0]?1:e<W[1]?2:e<W[2]?3:e<W[3]?5:9};xe.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function pu(r,e,t,n){return new m(d.negint,-1-le(r,e+1,n),2)}function hu(r,e,t,n){return new m(d.negint,-1-de(r,e+1,n),3)}function yu(r,e,t,n){return new m(d.negint,-1-pe(r,e+1,n),5)}var Ei=BigInt(-1),mu=BigInt(1);function gu(r,e,t,n){let o=he(r,e+1,n);if(typeof o!="bigint"){let i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new m(d.negint,i,9)}if(n.allowBigInt!==!0)throw new Error(`${C} integers outside of the safe integer range are not supported`);return new m(d.negint,Ei-BigInt(o),9)}function Ln(r,e){let t=e.value,n=typeof t=="bigint"?t*Ei-mu:t*-1-1;Z(r,e.type.majorEncoded,n)}Ln.encodedSize=function(e){let t=e.value,n=typeof t=="bigint"?t*Ei-mu:t*-1-1;return n<W[0]?1:n<W[1]?2:n<W[2]?3:n<W[3]?5:9};Ln.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function Lr(r,e,t,n){nt(r,e,t+n);let o=ir(r,e+t,e+t+n);return new m(d.bytes,o,t+n)}function wu(r,e,t,n){return Lr(r,e,1,t)}function bu(r,e,t,n){return Lr(r,e,2,le(r,e+1,n))}function Du(r,e,t,n){return Lr(r,e,3,de(r,e+1,n))}function vu(r,e,t,n){return Lr(r,e,5,pe(r,e+1,n))}function Eu(r,e,t,n){let o=he(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer bytes lengths not supported`);return Lr(r,e,9,o)}function $n(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===d.string?iu(r.value):r.value),r.encodedBytes}function sr(r,e){let t=$n(e);Z(r,e.type.majorEncoded,t.length),r.push(t)}sr.encodedSize=function(e){let t=$n(e);return Z.encodedSize(t.length)+t.length};sr.compareTokens=function(e,t){return ny($n(e),$n(t))};function ny(r,e){return r.length<e.length?-1:r.length>e.length?1:uu(r,e)}function $r(r,e,t,n,o){let i=t+n;nt(r,e,i);let s=new m(d.string,ou(r,e+t,e+i),i);return o.retainStringBytes===!0&&(s.byteValue=ir(r,e+t,e+i)),s}function _u(r,e,t,n){return $r(r,e,1,t,n)}function xu(r,e,t,n){return $r(r,e,2,le(r,e+1,n),n)}function Cu(r,e,t,n){return $r(r,e,3,de(r,e+1,n),n)}function Au(r,e,t,n){return $r(r,e,5,pe(r,e+1,n),n)}function Su(r,e,t,n){let o=he(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer string lengths not supported`);return $r(r,e,9,o,n)}var Ou=sr;function ar(r,e,t,n){return new m(d.array,n,t)}function Tu(r,e,t,n){return ar(r,e,1,t)}function ku(r,e,t,n){return ar(r,e,2,le(r,e+1,n))}function Iu(r,e,t,n){return ar(r,e,3,de(r,e+1,n))}function Pu(r,e,t,n){return ar(r,e,5,pe(r,e+1,n))}function Bu(r,e,t,n){let o=he(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer array lengths not supported`);return ar(r,e,9,o)}function Ru(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return ar(r,e,1,1/0)}function Mn(r,e){Z(r,d.array.majorEncoded,e.value)}Mn.compareTokens=xe.compareTokens;Mn.encodedSize=function(e){return Z.encodedSize(e.value)};function ur(r,e,t,n){return new m(d.map,n,t)}function Nu(r,e,t,n){return ur(r,e,1,t)}function Fu(r,e,t,n){return ur(r,e,2,le(r,e+1,n))}function Lu(r,e,t,n){return ur(r,e,3,de(r,e+1,n))}function $u(r,e,t,n){return ur(r,e,5,pe(r,e+1,n))}function Mu(r,e,t,n){let o=he(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer map lengths not supported`);return ur(r,e,9,o)}function ju(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return ur(r,e,1,1/0)}function jn(r,e){Z(r,d.map.majorEncoded,e.value)}jn.compareTokens=xe.compareTokens;jn.encodedSize=function(e){return Z.encodedSize(e.value)};function qu(r,e,t,n){return new m(d.tag,t,1)}function Uu(r,e,t,n){return new m(d.tag,le(r,e+1,n),2)}function zu(r,e,t,n){return new m(d.tag,de(r,e+1,n),3)}function Ku(r,e,t,n){return new m(d.tag,pe(r,e+1,n),5)}function Vu(r,e,t,n){return new m(d.tag,he(r,e+1,n),9)}function qn(r,e){Z(r,d.tag.majorEncoded,e.value)}qn.compareTokens=xe.compareTokens;qn.encodedSize=function(e){return Z.encodedSize(e.value)};var cy=20,fy=21,ly=22,dy=23;function Wu(r,e,t,n){if(n.allowUndefined===!1)throw new Error(`${C} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new m(d.null,null,1):new m(d.undefined,void 0,1)}function Qu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return new m(d.break,void 0,1)}function _i(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${C} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${C} Infinity values are not supported`)}return new m(d.float,r,e)}function Hu(r,e,t,n){return _i(xi(r,e+1),3,n)}function Gu(r,e,t,n){return _i(Ci(r,e+1),5,n)}function Ju(r,e,t,n){return _i(ec(r,e+1),9,n)}function Un(r,e,t){let n=e.value;if(n===!1)r.push([d.float.majorEncoded|cy]);else if(n===!0)r.push([d.float.majorEncoded|fy]);else if(n===null)r.push([d.float.majorEncoded|ly]);else if(n===void 0)r.push([d.float.majorEncoded|dy]);else{let o,i=!1;(!t||t.float64!==!0)&&(Zu(n),o=xi(Ie,1),n===o||Number.isNaN(n)?(Ie[0]=249,r.push(Ie.slice(0,3)),i=!0):(Xu(n),o=Ci(Ie,1),n===o&&(Ie[0]=250,r.push(Ie.slice(0,5)),i=!0))),i||(py(n),o=ec(Ie,1),Ie[0]=251,r.push(Ie.slice(0,9)))}}Un.encodedSize=function(e,t){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){Zu(n);let o=xi(Ie,1);if(n===o||Number.isNaN(n))return 3;if(Xu(n),o=Ci(Ie,1),n===o)return 5}return 9};var Yu=new ArrayBuffer(9),Ce=new DataView(Yu,1),Ie=new Uint8Array(Yu,0);function Zu(r){if(r===1/0)Ce.setUint16(0,31744,!1);else if(r===-1/0)Ce.setUint16(0,64512,!1);else if(Number.isNaN(r))Ce.setUint16(0,32256,!1);else{Ce.setFloat32(0,r);let e=Ce.getUint32(0),t=(e&2139095040)>>23,n=e&8388607;if(t===255)Ce.setUint16(0,31744,!1);else if(t===0)Ce.setUint16(0,(r&2147483648)>>16|n>>13,!1);else{let o=t-127;o<-24?Ce.setUint16(0,0):o<-14?Ce.setUint16(0,(e&2147483648)>>16|1<<24+o,!1):Ce.setUint16(0,(e&2147483648)>>16|o+15<<10|n>>13,!1)}}}function xi(r,e){if(r.length-e<2)throw new Error(`${C} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,o=t&1023,i;return n===0?i=o*2**-24:n!==31?i=(o+1024)*2**(n-25):i=o===0?1/0:NaN,t&32768?-i:i}function Xu(r){Ce.setFloat32(0,r,!1)}function Ci(r,e){if(r.length-e<4)throw new Error(`${C} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function py(r){Ce.setFloat64(0,r,!1)}function ec(r,e){if(r.length-e<8)throw new Error(`${C} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}Un.compareTokens=xe.compareTokens;function T(r,e,t){throw new Error(`${C} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function zn(r){return()=>{throw new Error(`${C} ${r}`)}}var y=[];for(let r=0;r<=23;r++)y[r]=T;y[24]=cu;y[25]=fu;y[26]=lu;y[27]=du;y[28]=T;y[29]=T;y[30]=T;y[31]=T;for(let r=32;r<=55;r++)y[r]=T;y[56]=pu;y[57]=hu;y[58]=yu;y[59]=gu;y[60]=T;y[61]=T;y[62]=T;y[63]=T;for(let r=64;r<=87;r++)y[r]=wu;y[88]=bu;y[89]=Du;y[90]=vu;y[91]=Eu;y[92]=T;y[93]=T;y[94]=T;y[95]=zn("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)y[r]=_u;y[120]=xu;y[121]=Cu;y[122]=Au;y[123]=Su;y[124]=T;y[125]=T;y[126]=T;y[127]=zn("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)y[r]=Tu;y[152]=ku;y[153]=Iu;y[154]=Pu;y[155]=Bu;y[156]=T;y[157]=T;y[158]=T;y[159]=Ru;for(let r=160;r<=183;r++)y[r]=Nu;y[184]=Fu;y[185]=Lu;y[186]=$u;y[187]=Mu;y[188]=T;y[189]=T;y[190]=T;y[191]=ju;for(let r=192;r<=215;r++)y[r]=qu;y[216]=Uu;y[217]=zu;y[218]=Ku;y[219]=Vu;y[220]=T;y[221]=T;y[222]=T;y[223]=T;for(let r=224;r<=243;r++)y[r]=zn("simple values are not supported");y[244]=T;y[245]=T;y[246]=T;y[247]=Wu;y[248]=zn("simple values are not supported");y[249]=Hu;y[250]=Gu;y[251]=Ju;y[252]=T;y[253]=T;y[254]=T;y[255]=Qu;var Pe=[];for(let r=0;r<24;r++)Pe[r]=new m(d.uint,r,1);for(let r=-1;r>=-24;r--)Pe[31-r]=new m(d.negint,r,1);Pe[64]=new m(d.bytes,new Uint8Array(0),1);Pe[96]=new m(d.string,"",1);Pe[128]=new m(d.array,0,1);Pe[160]=new m(d.map,0,1);Pe[244]=new m(d.false,!1,1);Pe[245]=new m(d.true,!0,1);Pe[246]=new m(d.null,null,1);function tc(r){switch(r.type){case d.false:return Ve([244]);case d.true:return Ve([245]);case d.null:return Ve([246]);case d.bytes:return r.value.length?void 0:Ve([64]);case d.string:return r.value===""?Ve([96]):void 0;case d.array:return r.value===0?Ve([128]):void 0;case d.map:return r.value===0?Ve([160]):void 0;case d.uint:return r.value<24?Ve([Number(r.value)]):void 0;case d.negint:if(r.value>=-24)return Ve([31-Number(r.value)])}}var yy={float64:!1,mapSorter:wy,quickEncodeToken:tc};function my(){let r=[];return r[d.uint.major]=xe,r[d.negint.major]=Ln,r[d.bytes.major]=sr,r[d.string.major]=Ou,r[d.array.major]=Mn,r[d.map.major]=jn,r[d.tag.major]=qn,r[d.float.major]=Un,r}var rc=my(),Ai=new Nr,cr=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${vi} object contains circular references`);return new cr(t,e)}},lt={null:new m(d.null,null),undefined:new m(d.undefined,void 0),true:new m(d.true,!0),false:new m(d.false,!1),emptyArray:new m(d.array,0),emptyMap:new m(d.map,0)},dt={number(r,e,t,n){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new m(d.float,r):r>=0?new m(d.uint,r):new m(d.negint,r)},bigint(r,e,t,n){return r>=BigInt(0)?new m(d.uint,r):new m(d.negint,r)},Uint8Array(r,e,t,n){return new m(d.bytes,r)},string(r,e,t,n){return new m(d.string,r)},boolean(r,e,t,n){return r?lt.true:lt.false},null(r,e,t,n){return lt.null},undefined(r,e,t,n){return lt.undefined},ArrayBuffer(r,e,t,n){return new m(d.bytes,new Uint8Array(r))},DataView(r,e,t,n){return new m(d.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,n){if(!r.length)return t.addBreakTokens===!0?[lt.emptyArray,new m(d.break)]:lt.emptyArray;n=cr.createCheck(n,r);let o=[],i=0;for(let s of r)o[i++]=Kn(s,t,n);return t.addBreakTokens?[new m(d.array,r.length),o,new m(d.break)]:[new m(d.array,r.length),o]},Object(r,e,t,n){let o=e!=="Object",i=o?r.keys():Object.keys(r),s=o?r.size:i.length;if(!s)return t.addBreakTokens===!0?[lt.emptyMap,new m(d.break)]:lt.emptyMap;n=cr.createCheck(n,r);let a=[],u=0;for(let f of i)a[u++]=[Kn(f,t,n),Kn(o?r.get(f):r[f],t,n)];return gy(a,t),t.addBreakTokens?[new m(d.map,s),a,new m(d.break)]:[new m(d.map,s),a]}};dt.Map=dt.Object;dt.Buffer=dt.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))dt[`${r}Array`]=dt.DataView;function Kn(r,e={},t){let n=eu(r),o=e&&e.typeEncoders&&e.typeEncoders[n]||dt[n];if(typeof o=="function"){let s=o(r,n,e,t);if(s!=null)return s}let i=dt[n];if(!i)throw new Error(`${vi} unsupported type: ${n}`);return i(r,n,e,t)}function gy(r,e){e.mapSorter&&r.sort(e.mapSorter)}function wy(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==n.type)return t.type.compare(n.type);let o=t.type.major,i=rc[o].compareTokens(t,n);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function nc(r,e,t,n){if(Array.isArray(e))for(let o of e)nc(r,o,t,n);else t[e.type.major](r,e,n)}function by(r,e,t){let n=Kn(r,t);if(!Array.isArray(n)&&t.quickEncodeToken){let o=t.quickEncodeToken(n);if(o)return o;let i=e[n.type.major];if(i.encodedSize){let s=i.encodedSize(n,t),a=new Nr(s);if(i(a,n,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Di(a.chunks[0])}}return Ai.reset(),nc(Ai,n,e,t),Ai.toBytes(!0)}function Pt(r,e){return e=Object.assign({},yy,e),by(r,rc,e)}var Dy={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},Si=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=Pe[e];if(t===void 0){let n=y[e];if(!n)throw new Error(`${C} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let o=e&31;t=n(this.data,this.pos,o,this.options)}return this.pos+=t.encodedLength,t}},Mr=Symbol.for("DONE"),Vn=Symbol.for("BREAK");function vy(r,e,t){let n=[];for(let o=0;o<r.value;o++){let i=jr(e,t);if(i===Vn){if(r.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed array`)}if(i===Mr)throw new Error(`${C} found array but not enough entries (got ${o}, expected ${r.value})`);n[o]=i}return n}function Ey(r,e,t){let n=t.useMaps===!0,o=n?void 0:{},i=n?new Map:void 0;for(let s=0;s<r.value;s++){let a=jr(e,t);if(a===Vn){if(r.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed map`)}if(a===Mr)throw new Error(`${C} found map but not enough entries (got ${s} [no key], expected ${r.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${C} non-string keys not supported (got ${typeof a})`);let u=jr(e,t);if(u===Mr)throw new Error(`${C} found map but not enough entries (got ${s} [no value], expected ${r.value})`);n?i.set(a,u):o[a]=u}return n?i:o}function jr(r,e){if(r.done())return Mr;let t=r.next();if(t.type===d.break)return Vn;if(t.type.terminal)return t.value;if(t.type===d.array)return vy(t,r,e);if(t.type===d.map)return Ey(t,r,e);if(t.type===d.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let n=jr(r,e);return e.tags[t.value](n)}throw new Error(`${C} tag not supported (${t.value})`)}throw new Error("unsupported")}function We(r,e){if(!(r instanceof Uint8Array))throw new Error(`${C} data to decode must be a Uint8Array`);e=Object.assign({},Dy,e);let t=e.tokenizer||new Si(r,e),n=jr(t,e);if(n===Mr)throw new Error(`${C} did not find any content to decode`);if(n===Vn)throw new Error(`${C} got unexpected break`);if(!t.done())throw new Error(`${C} too many terminals, data makes no sense`);return n}fe();var Nt=A(mt(),1),tf=Nt.default.Reader,Py=Nt.default.Writer,s0=Nt.default.util,Jn=Nt.default.roots.default||(Nt.default.roots.default={}),rf=Jn.ipfs=(()=>{let r={};return r.pin=function(){let e={};return e.Set=function(){function t(n){if(n)for(var o=Object.keys(n),i=0;i<o.length;++i)n[o[i]]!=null&&(this[o[i]]=n[o[i]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(o,i){return i||(i=Py.create()),o.version!=null&&Object.hasOwnProperty.call(o,"version")&&i.uint32(8).uint32(o.version),o.fanout!=null&&Object.hasOwnProperty.call(o,"fanout")&&i.uint32(16).uint32(o.fanout),o.seed!=null&&Object.hasOwnProperty.call(o,"seed")&&i.uint32(29).fixed32(o.seed),i},t.decode=function(o,i){o instanceof tf||(o=tf.create(o));for(var s=i===void 0?o.len:o.pos+i,a=new Jn.ipfs.pin.Set;o.pos<s;){var u=o.uint32();switch(u>>>3){case 1:a.version=o.uint32();break;case 2:a.fanout=o.uint32();break;case 3:a.seed=o.fixed32();break;default:o.skipType(u&7);break}}return a},t.fromObject=function(o){if(o instanceof Jn.ipfs.pin.Set)return o;var i=new Jn.ipfs.pin.Set;return o.version!=null&&(i.version=o.version>>>0),o.fanout!=null&&(i.fanout=o.fanout>>>0),o.seed!=null&&(i.seed=o.seed>>>0),i},t.toObject=function(o,i){i||(i={});var s={};return i.defaults&&(s.version=0,s.fanout=0,s.seed=0),o.version!=null&&o.hasOwnProperty("version")&&(s.version=o.version),o.fanout!=null&&o.hasOwnProperty("fanout")&&(s.fanout=o.fanout),o.seed!=null&&o.hasOwnProperty("seed")&&(s.seed=o.seed),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Nt.default.util.toJSONOptions)},t}(),e}(),r})();var gf=A(of(),1),eo=A(Kr(),1);et();fe();var Vr=new x("/local/pins"),Zn=256,yf=8192,Ki=E.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),Ft={direct:"direct",recursive:"recursive"};function Vi(r){return new x(`/${M.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}Xn();function mf(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}_e();Ke();Tn();var Qi=rf.pin.Set;function Wy(r){let e=r.Data;if(!e)throw new Error("No data present");let t=eo.default.decode(e),n=eo.default.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+t>e.length)throw new Error("Impossibly large set header length");let o=e.slice(n,t+n),i=Qi.toObject(Qi.decode(o),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(i.version!==1)throw new Error(`Unsupported Set version: ${i.version}`);if(i.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:i,data:e.slice(t+n)}}function Qy(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let o=Y(e.toString()),i=Wr([t,o],t.byteLength+o.byteLength);return(0,gf.default)(re(i))}async function*wf(r,e){let t=Wy(e),n=0;for(let o of e.Links){if(n<t.header.fanout){let i=o.Hash;if(!Ki.equals(i)){let s=await r.get(i),a=Rr(s);yield*wf(r,a)}}else yield o.Hash;n++}}async function*Qr(r,e,t){let n=e.Links.find(s=>s.Name===t);if(!n)throw new Error("No link found with name "+t);let o=await r.get(n.Hash),i=Rr(o);yield*wf(r,i)}function Hy(r,e){return t(e,0);async function t(n,o){let i=Qi.encode({version:1,fanout:Zn,seed:o}).finish(),s=eo.default.encode(i.length),a=Wr([s,i]),u=[];for(let c=0;c<Zn;c++)u.push({Name:"",Tsize:1,Hash:Ki});if(n.length<=yf){let c=n.map(D=>({link:{Name:"",Tsize:1,Hash:D.key},data:D.data||new Uint8Array})).sort((D,h)=>mf(D.link.Hash.bytes,h.link.Hash.bytes)),l=u.concat(c.map(D=>D.link));return{Data:Wr([a,...c.map(D=>D.data)]),Links:l}}else{let c=n.reduce((p,D)=>{let h=Qy(o,D.key)%Zn;return p[h]=h in p?p[h].concat([D]):[D],p},[]),l=0;for(let p of c){let D=await t(p,o+1);await f(D,l),l++}return{Data:a,Links:u}}async function f(c,l){let p=Br(c),D=await rr.digest(p),h=E.createV0(D);await r.put(h,p);let g=c.Links.reduce((S,R)=>S+(R.Tsize||0),0)+p.length;u[l]={Name:"",Tsize:g,Hash:h}}}}async function Hi(r,e,t){let n=await Hy(r,t.map(u=>({key:u}))),o=Br(n),i=await rr.digest(o),s=E.createV0(i);await r.put(s,o);let a=n.Links.reduce((u,f)=>u+f.Tsize,0)+o.length;return{Name:e,Tsize:a,Hash:s}}var to=A(gi(),1);Tn();Xe();et();async function Jy(r,e,t,n){if(!await e.has(Vr))return;let o=await e.get(Vr),i=E.decode(o),s=await r.get(i),a=Rr(s),u=0,f=await(0,to.default)(Qr(r,a,Ft.recursive))+await(0,to.default)(Qr(r,a,Ft.direct));for await(let c of Qr(r,a,Ft.recursive)){u++;let l={depth:1/0};c.version!==0&&(l.version=c.version),c.code!==rt&&(l.codec=c.code),await t.put(Vi(c),Pt(l)),n(u/f*100,`Migrated recursive pin ${c}`)}for await(let c of Qr(r,a,Ft.direct)){u++;let l={depth:0};c.version!==0&&(l.version=c.version),c.code!==rt&&(l.codec=c.code),await t.put(Vi(c),Pt(l)),n(u/f*100,`Migrated direct pin ${c}`)}await r.delete(i),await e.delete(Vr)}async function Yy(r,e,t,n){let o=[],i=[],s=0,a=await(0,to.default)(t.queryKeys({}));for await(let{key:p,value:D}of t.query({})){s++;let h=We(D),g=E.create(h.version||0,h.codec||rt,Ze(M.decode("b"+p.toString().toLowerCase().split("/").pop())));h.depth===0?(n(s/a*100,`Reverted direct pin ${g}`),i.push(g)):(n(s/a*100,`Reverted recursive pin ${g}`),o.push(g))}n(100,"Updating pin root");let u={Links:[await Hi(r,Ft.direct,i),await Hi(r,Ft.recursive,o)]},f=Br(u),c=await rr.digest(f),l=E.createV0(c);await r.put(l,f),await e.put(Vr,l.bytes)}async function bf(r,e,t){let n=r.blocks,o=r.datastore,i=r.pins;await n.open(),await o.open(),await i.open();try{await t(n,o,i,e)}finally{await i.close(),await o.close(),await n.close()}}var Df={version:9,description:"Migrates pins to datastore",migrate:(r,e=()=>{})=>bf(r,e,Jy),revert:(r,e=()=>{})=>bf(r,e,Yy)};var vf=A(Je(),1);function Hr(r){return r=r||new Error("Not Found"),(0,vf.default)(r,"ERR_NOT_FOUND")}var Ef=new x("/config"),Gr=new x("/version");function Jr(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function Zy(r,e,t){let n=await e(r);if(n)return n;let o=Jr(t);return o?new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{i(Boolean(a.result))}}):!1}async function Xy(r,e,t,n){if(await t(r))return e(r);let o=Jr(n);if(!o)throw Hr();return new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return i(a.result);s(Hr())}})}function ro(r){let e=r.get.bind(r),t=r.has.bind(r);return r.get=n=>Xy(n,e,t,r),r.has=n=>Zy(n,t,r),r}function Gi(r){return{...r,root:ro(r.root),datastore:ro(r.datastore),pins:ro(r.pins),keys:ro(r.keys)}}Ke();_e();async function em(r,e,t=()=>{}){let n=Jr(e);if(!n){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await Af(n,(i,s)=>[{type:"del",key:i},{type:"put",key:Y(i),value:s}])}async function tm(r,e,t=()=>{}){let n=Jr(e);if(!n){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await Af(n,(i,s)=>[{type:"del",key:i},{type:"put",key:re(i),value:s}])}function xf(r){return r.child?xf(r.child):r}async function _f(r,e,t){let n=Object.entries(r).map(([s,a])=>({key:s,backend:xf(a)})).filter(({key:s,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:s,backend:a})=>({name:s,store:a}));e(0,`Migrating ${n.length} dbs`);let o=0,i=s=>{e(Math.round(o/n.length*100),s)};for(let{name:s,store:a}of n){await a.open();try{await t(s,a,i)}finally{o++,await a.close()}}e(100,`Migrated ${n.length} dbs`)}var Cf={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=()=>{})=>_f(r,e,em),revert:(r,e=()=>{})=>_f(r,e,tm)};function Af(r,e){function t(n,o){let i=r.store("readwrite"),s=i.transaction,a=0,u;s.onabort=()=>o(u||s.error||new Error("aborted by user")),s.oncomplete=()=>o();function f(){let c=n[a++],l=c.key,p;try{p=c.type==="del"?i.delete(l):i.put(c.value,l)}catch(D){u=D,s.abort();return}a<n.length&&(p.onsuccess=f)}f()}return new Promise((n,o)=>{let i=r.iterator(),s=u=>u;i._deserializeKey=i._deserializeValue=s,a();function a(){let u=(f,c,l)=>{if(f||c===void 0){let p=D=>{if(D){o(D);return}n()};i.end(p);return}t(e(c,l),a)};i.next(u)}})}var gt=new x("/local/filesroot");async function rm(r,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await r.root.open(),await r.datastore.open(),await r.root.has(gt)){let t=await r.root.get(gt);await r.datastore.put(gt,t),await r.root.delete(gt)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo datastore")}async function nm(r,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await r.root.open(),await r.datastore.open(),await r.datastore.has(gt)){let t=await r.datastore.get(gt);await r.root.put(gt,t),await r.datastore.delete(gt)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo root datastore")}var Sf={version:11,description:"Store mfs root in the datastore",migrate:rm,revert:nm};var ds=A(mt(),1);var Lt=A(mt(),1),Of=Lt.default.Reader,om=Lt.default.Writer,im=Lt.default.util,no=Lt.default.roots.default||(Lt.default.roots.default={}),Ji=no.Protocols=(()=>{function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.protocols=im.emptyArray,r.encode=function(t,n){if(n||(n=om.create()),t.protocols!=null&&t.protocols.length)for(var o=0;o<t.protocols.length;++o)n.uint32(10).string(t.protocols[o]);return n},r.decode=function(t,n){t instanceof Of||(t=Of.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new no.Protocols;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.protocols&&i.protocols.length||(i.protocols=[]),i.protocols.push(t.string());break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof no.Protocols)return t;var n=new no.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var o=0;o<t.protocols.length;++o)n.protocols[o]=String(t.protocols[o])}return n},r.toObject=function(t,n){n||(n={});var o={};if((n.arrays||n.defaults)&&(o.protocols=[]),t.protocols&&t.protocols.length){o.protocols=[];for(var i=0;i<t.protocols.length;++i)o.protocols[i]=t.protocols[i]}return o},r.prototype.toJSON=function(){return this.constructor.toObject(this,Lt.default.util.toJSONOptions)},r})();var ot=A(mt(),1),lr=ot.default.Reader,Yi=ot.default.Writer,P=ot.default.util,H=ot.default.roots.default||(ot.default.roots.default={}),Zi=H.Addresses=(()=>{function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.addrs=P.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,n){if(n||(n=Yi.create()),t.addrs!=null&&t.addrs.length)for(var o=0;o<t.addrs.length;++o)H.Addresses.Address.encode(t.addrs[o],n.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&H.Addresses.CertifiedRecord.encode(t.certifiedRecord,n.uint32(18).fork()).ldelim(),n},r.decode=function(t,n){t instanceof lr||(t=lr.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new H.Addresses;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.addrs&&i.addrs.length||(i.addrs=[]),i.addrs.push(H.Addresses.Address.decode(t,t.uint32()));break;case 2:i.certifiedRecord=H.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof H.Addresses)return t;var n=new H.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var o=0;o<t.addrs.length;++o){if(typeof t.addrs[o]!="object")throw TypeError(".Addresses.addrs: object expected");n.addrs[o]=H.Addresses.Address.fromObject(t.addrs[o])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=H.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return n},r.toObject=function(t,n){n||(n={});var o={};if((n.arrays||n.defaults)&&(o.addrs=[]),n.defaults&&(o.certifiedRecord=null),t.addrs&&t.addrs.length){o.addrs=[];for(var i=0;i<t.addrs.length;++i)o.addrs[i]=H.Addresses.Address.toObject(t.addrs[i],n)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(o.certifiedRecord=H.Addresses.CertifiedRecord.toObject(t.certifiedRecord,n)),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,ot.default.util.toJSONOptions)},r.Address=function(){function e(n){if(n)for(var o=Object.keys(n),i=0;i<o.length;++i)n[o[i]]!=null&&(this[o[i]]=n[o[i]])}e.prototype.multiaddr=P.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:P.oneOfGetter(t=["isCertified"]),set:P.oneOfSetter(t)}),e.encode=function(o,i){return i||(i=Yi.create()),o.multiaddr!=null&&Object.hasOwnProperty.call(o,"multiaddr")&&i.uint32(10).bytes(o.multiaddr),o.isCertified!=null&&Object.hasOwnProperty.call(o,"isCertified")&&i.uint32(16).bool(o.isCertified),i},e.decode=function(o,i){o instanceof lr||(o=lr.create(o));for(var s=i===void 0?o.len:o.pos+i,a=new H.Addresses.Address;o.pos<s;){var u=o.uint32();switch(u>>>3){case 1:a.multiaddr=o.bytes();break;case 2:a.isCertified=o.bool();break;default:o.skipType(u&7);break}}return a},e.fromObject=function(o){if(o instanceof H.Addresses.Address)return o;var i=new H.Addresses.Address;return o.multiaddr!=null&&(typeof o.multiaddr=="string"?P.base64.decode(o.multiaddr,i.multiaddr=P.newBuffer(P.base64.length(o.multiaddr)),0):o.multiaddr.length&&(i.multiaddr=o.multiaddr)),o.isCertified!=null&&(i.isCertified=Boolean(o.isCertified)),i},e.toObject=function(o,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=P.newBuffer(s.multiaddr)))),o.multiaddr!=null&&o.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?P.base64.encode(o.multiaddr,0,o.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(o.multiaddr):o.multiaddr),o.isCertified!=null&&o.hasOwnProperty("isCertified")&&(s.isCertified=o.isCertified,i.oneofs&&(s._isCertified="isCertified")),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,ot.default.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}return e.prototype.seq=P.Long?P.Long.fromBits(0,0,!0):0,e.prototype.raw=P.newBuffer([]),e.encode=function(n,o){return o||(o=Yi.create()),n.seq!=null&&Object.hasOwnProperty.call(n,"seq")&&o.uint32(8).uint64(n.seq),n.raw!=null&&Object.hasOwnProperty.call(n,"raw")&&o.uint32(18).bytes(n.raw),o},e.decode=function(n,o){n instanceof lr||(n=lr.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new H.Addresses.CertifiedRecord;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.seq=n.uint64();break;case 2:s.raw=n.bytes();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof H.Addresses.CertifiedRecord)return n;var o=new H.Addresses.CertifiedRecord;return n.seq!=null&&(P.Long?(o.seq=P.Long.fromValue(n.seq)).unsigned=!0:typeof n.seq=="string"?o.seq=parseInt(n.seq,10):typeof n.seq=="number"?o.seq=n.seq:typeof n.seq=="object"&&(o.seq=new P.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),n.raw!=null&&(typeof n.raw=="string"?P.base64.decode(n.raw,o.raw=P.newBuffer(P.base64.length(n.raw)),0):n.raw.length&&(o.raw=n.raw)),o},e.toObject=function(n,o){o||(o={});var i={};if(o.defaults){if(P.Long){var s=new P.Long(0,0,!0);i.seq=o.longs===String?s.toString():o.longs===Number?s.toNumber():s}else i.seq=o.longs===String?"0":0;o.bytes===String?i.raw="":(i.raw=[],o.bytes!==Array&&(i.raw=P.newBuffer(i.raw)))}return n.seq!=null&&n.hasOwnProperty("seq")&&(typeof n.seq=="number"?i.seq=o.longs===String?String(n.seq):n.seq:i.seq=o.longs===String?P.Long.prototype.toString.call(n.seq):o.longs===Number?new P.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),n.raw!=null&&n.hasOwnProperty("raw")&&(i.raw=o.bytes===String?P.base64.encode(n.raw,0,n.raw.length):o.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,ot.default.util.toJSONOptions)},e}(),r})();var it=A(mt(),1),dr=it.default.Reader,Xi=it.default.Writer,I=it.default.util,K=it.default.roots.default||(it.default.roots.default={}),es=K.Peer=(()=>{function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}r.prototype.addresses=I.emptyArray,r.prototype.protocols=I.emptyArray,r.prototype.metadata=I.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(r.prototype,"_pubKey",{get:I.oneOfGetter(e=["pubKey"]),set:I.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:I.oneOfGetter(e=["peerRecordEnvelope"]),set:I.oneOfSetter(e)}),r.encode=function(n,o){if(o||(o=Xi.create()),n.addresses!=null&&n.addresses.length)for(var i=0;i<n.addresses.length;++i)K.Address.encode(n.addresses[i],o.uint32(10).fork()).ldelim();if(n.protocols!=null&&n.protocols.length)for(var i=0;i<n.protocols.length;++i)o.uint32(18).string(n.protocols[i]);if(n.metadata!=null&&n.metadata.length)for(var i=0;i<n.metadata.length;++i)K.Metadata.encode(n.metadata[i],o.uint32(26).fork()).ldelim();return n.pubKey!=null&&Object.hasOwnProperty.call(n,"pubKey")&&o.uint32(34).bytes(n.pubKey),n.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&o.uint32(42).bytes(n.peerRecordEnvelope),o},r.decode=function(n,o){n instanceof dr||(n=dr.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new K.Peer;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(K.Address.decode(n,n.uint32()));break;case 2:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(n.string());break;case 3:s.metadata&&s.metadata.length||(s.metadata=[]),s.metadata.push(K.Metadata.decode(n,n.uint32()));break;case 4:s.pubKey=n.bytes();break;case 5:s.peerRecordEnvelope=n.bytes();break;default:n.skipType(a&7);break}}return s},r.fromObject=function(n){if(n instanceof K.Peer)return n;var o=new K.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");o.addresses=[];for(var i=0;i<n.addresses.length;++i){if(typeof n.addresses[i]!="object")throw TypeError(".Peer.addresses: object expected");o.addresses[i]=K.Address.fromObject(n.addresses[i])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");o.protocols=[];for(var i=0;i<n.protocols.length;++i)o.protocols[i]=String(n.protocols[i])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");o.metadata=[];for(var i=0;i<n.metadata.length;++i){if(typeof n.metadata[i]!="object")throw TypeError(".Peer.metadata: object expected");o.metadata[i]=K.Metadata.fromObject(n.metadata[i])}}return n.pubKey!=null&&(typeof n.pubKey=="string"?I.base64.decode(n.pubKey,o.pubKey=I.newBuffer(I.base64.length(n.pubKey)),0):n.pubKey.length&&(o.pubKey=n.pubKey)),n.peerRecordEnvelope!=null&&(typeof n.peerRecordEnvelope=="string"?I.base64.decode(n.peerRecordEnvelope,o.peerRecordEnvelope=I.newBuffer(I.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(o.peerRecordEnvelope=n.peerRecordEnvelope)),o},r.toObject=function(n,o){o||(o={});var i={};if((o.arrays||o.defaults)&&(i.addresses=[],i.protocols=[],i.metadata=[]),n.addresses&&n.addresses.length){i.addresses=[];for(var s=0;s<n.addresses.length;++s)i.addresses[s]=K.Address.toObject(n.addresses[s],o)}if(n.protocols&&n.protocols.length){i.protocols=[];for(var s=0;s<n.protocols.length;++s)i.protocols[s]=n.protocols[s]}if(n.metadata&&n.metadata.length){i.metadata=[];for(var s=0;s<n.metadata.length;++s)i.metadata[s]=K.Metadata.toObject(n.metadata[s],o)}return n.pubKey!=null&&n.hasOwnProperty("pubKey")&&(i.pubKey=o.bytes===String?I.base64.encode(n.pubKey,0,n.pubKey.length):o.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,o.oneofs&&(i._pubKey="pubKey")),n.peerRecordEnvelope!=null&&n.hasOwnProperty("peerRecordEnvelope")&&(i.peerRecordEnvelope=o.bytes===String?I.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):o.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,o.oneofs&&(i._peerRecordEnvelope="peerRecordEnvelope")),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,it.default.util.toJSONOptions)},r})(),z0=K.Address=(()=>{function r(t){if(t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}r.prototype.multiaddr=I.newBuffer([]),r.prototype.isCertified=null;let e;return Object.defineProperty(r.prototype,"_isCertified",{get:I.oneOfGetter(e=["isCertified"]),set:I.oneOfSetter(e)}),r.encode=function(n,o){return o||(o=Xi.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&o.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&o.uint32(16).bool(n.isCertified),o},r.decode=function(n,o){n instanceof dr||(n=dr.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new K.Address;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.multiaddr=n.bytes();break;case 2:s.isCertified=n.bool();break;default:n.skipType(a&7);break}}return s},r.fromObject=function(n){if(n instanceof K.Address)return n;var o=new K.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?I.base64.decode(n.multiaddr,o.multiaddr=I.newBuffer(I.base64.length(n.multiaddr)),0):n.multiaddr.length&&(o.multiaddr=n.multiaddr)),n.isCertified!=null&&(o.isCertified=Boolean(n.isCertified)),o},r.toObject=function(n,o){o||(o={});var i={};return o.defaults&&(o.bytes===String?i.multiaddr="":(i.multiaddr=[],o.bytes!==Array&&(i.multiaddr=I.newBuffer(i.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(i.multiaddr=o.bytes===String?I.base64.encode(n.multiaddr,0,n.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(i.isCertified=n.isCertified,o.oneofs&&(i._isCertified="isCertified")),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,it.default.util.toJSONOptions)},r})(),K0=K.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.key="",r.prototype.value=I.newBuffer([]),r.encode=function(t,n){return n||(n=Xi.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&n.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&n.uint32(18).bytes(t.value),n},r.decode=function(t,n){t instanceof dr||(t=dr.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new K.Metadata;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.key=t.string();break;case 2:i.value=t.bytes();break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof K.Metadata)return t;var n=new K.Metadata;return t.key!=null&&(n.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?I.base64.decode(t.value,n.value=I.newBuffer(I.base64.length(t.value)),0):t.value.length&&(n.value=t.value)),n},r.toObject=function(t,n){n||(n={});var o={};return n.defaults&&(o.key="",n.bytes===String?o.value="":(o.value=[],n.bytes!==Array&&(o.value=I.newBuffer(o.value)))),t.key!=null&&t.hasOwnProperty("key")&&(o.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(o.value=n.bytes===String?I.base64.encode(t.value,0,t.value.length):n.bytes===Array?Array.prototype.slice.call(t.value):t.value),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,it.default.util.toJSONOptions)},r})();var $t=A(mt(),1),Tf=$t.default.Reader,sm=$t.default.Writer,B=$t.default.util,oo=$t.default.roots.default||($t.default.roots.default={}),kf=oo.Envelope=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.publicKey=B.newBuffer([]),r.prototype.payloadType=B.newBuffer([]),r.prototype.payload=B.newBuffer([]),r.prototype.signature=B.newBuffer([]),r.encode=function(t,n){return n||(n=sm.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&n.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&n.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&n.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&n.uint32(42).bytes(t.signature),n},r.decode=function(t,n){t instanceof Tf||(t=Tf.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new oo.Envelope;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.publicKey=t.bytes();break;case 2:i.payloadType=t.bytes();break;case 3:i.payload=t.bytes();break;case 5:i.signature=t.bytes();break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof oo.Envelope)return t;var n=new oo.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?B.base64.decode(t.publicKey,n.publicKey=B.newBuffer(B.base64.length(t.publicKey)),0):t.publicKey.length&&(n.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?B.base64.decode(t.payloadType,n.payloadType=B.newBuffer(B.base64.length(t.payloadType)),0):t.payloadType.length&&(n.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?B.base64.decode(t.payload,n.payload=B.newBuffer(B.base64.length(t.payload)),0):t.payload.length&&(n.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?B.base64.decode(t.signature,n.signature=B.newBuffer(B.base64.length(t.signature)),0):t.signature.length&&(n.signature=t.signature)),n},r.toObject=function(t,n){n||(n={});var o={};return n.defaults&&(n.bytes===String?o.publicKey="":(o.publicKey=[],n.bytes!==Array&&(o.publicKey=B.newBuffer(o.publicKey))),n.bytes===String?o.payloadType="":(o.payloadType=[],n.bytes!==Array&&(o.payloadType=B.newBuffer(o.payloadType))),n.bytes===String?o.payload="":(o.payload=[],n.bytes!==Array&&(o.payload=B.newBuffer(o.payload))),n.bytes===String?o.signature="":(o.signature=[],n.bytes!==Array&&(o.signature=B.newBuffer(o.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(o.publicKey=n.bytes===String?B.base64.encode(t.publicKey,0,t.publicKey.length):n.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(o.payloadType=n.bytes===String?B.base64.encode(t.payloadType,0,t.payloadType.length):n.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(o.payload=n.bytes===String?B.base64.encode(t.payload,0,t.payload.length):n.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(o.signature=n.bytes===String?B.base64.encode(t.signature,0,t.signature.length):n.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,$t.default.util.toJSONOptions)},r})();var wt=A(mt(),1),io=wt.default.Reader,If=wt.default.Writer,$=wt.default.util,Ne=wt.default.roots.default||(wt.default.roots.default={}),Pf=Ne.PeerRecord=(()=>{function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.peerId=$.newBuffer([]),r.prototype.seq=$.Long?$.Long.fromBits(0,0,!0):0,r.prototype.addresses=$.emptyArray,r.encode=function(t,n){if(n||(n=If.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&n.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&n.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var o=0;o<t.addresses.length;++o)Ne.PeerRecord.AddressInfo.encode(t.addresses[o],n.uint32(26).fork()).ldelim();return n},r.decode=function(t,n){t instanceof io||(t=io.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new Ne.PeerRecord;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.peerId=t.bytes();break;case 2:i.seq=t.uint64();break;case 3:i.addresses&&i.addresses.length||(i.addresses=[]),i.addresses.push(Ne.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof Ne.PeerRecord)return t;var n=new Ne.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?$.base64.decode(t.peerId,n.peerId=$.newBuffer($.base64.length(t.peerId)),0):t.peerId.length&&(n.peerId=t.peerId)),t.seq!=null&&($.Long?(n.seq=$.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?n.seq=parseInt(t.seq,10):typeof t.seq=="number"?n.seq=t.seq:typeof t.seq=="object"&&(n.seq=new $.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var o=0;o<t.addresses.length;++o){if(typeof t.addresses[o]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[o]=Ne.PeerRecord.AddressInfo.fromObject(t.addresses[o])}}return n},r.toObject=function(t,n){n||(n={});var o={};if((n.arrays||n.defaults)&&(o.addresses=[]),n.defaults)if(n.bytes===String?o.peerId="":(o.peerId=[],n.bytes!==Array&&(o.peerId=$.newBuffer(o.peerId))),$.Long){var i=new $.Long(0,0,!0);o.seq=n.longs===String?i.toString():n.longs===Number?i.toNumber():i}else o.seq=n.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(o.peerId=n.bytes===String?$.base64.encode(t.peerId,0,t.peerId.length):n.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?o.seq=n.longs===String?String(t.seq):t.seq:o.seq=n.longs===String?$.Long.prototype.toString.call(t.seq):n.longs===Number?new $.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){o.addresses=[];for(var s=0;s<t.addresses.length;++s)o.addresses[s]=Ne.PeerRecord.AddressInfo.toObject(t.addresses[s],n)}return o},r.prototype.toJSON=function(){return this.constructor.toObject(this,wt.default.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}return e.prototype.multiaddr=$.newBuffer([]),e.encode=function(n,o){return o||(o=If.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&o.uint32(10).bytes(n.multiaddr),o},e.decode=function(n,o){n instanceof io||(n=io.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new Ne.PeerRecord.AddressInfo;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof Ne.PeerRecord.AddressInfo)return n;var o=new Ne.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?$.base64.decode(n.multiaddr,o.multiaddr=$.newBuffer($.base64.length(n.multiaddr)),0):n.multiaddr.length&&(o.multiaddr=n.multiaddr)),o},e.toObject=function(n,o){o||(o={});var i={};return o.defaults&&(o.bytes===String?i.multiaddr="":(i.multiaddr=[],o.bytes!==Array&&(i.multiaddr=$.newBuffer(i.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(i.multiaddr=o.bytes===String?$.base64.encode(n.multiaddr,0,n.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,wt.default.util.toJSONOptions)},e}(),r})();var ls=A(ml(),1);ds.default.util.Long=void 0;ds.default.configure();async function Bm(r,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await r.datastore.open();let t={},n=[];for await(let{key:o,value:i}of r.datastore.query({prefix:"/peers"})){n.push(o);let s=o.toString(),[a,u,f,c,l]=s.split("/");if(u==="peers"&&!!["protos","addrs","metadata","keys"].includes(f)&&!!c)if(t[c]=t[c]||{addresses:[],protocols:[],metadata:[]},f==="protos"){let p=Ji.decode(i);t[c].protocols=p.protocols.sort()}else if(f==="addrs"){let p=Zi.decode(i);t[c].addresses=p.addrs.sort((D,h)=>new ls.Multiaddr(D.multiaddr).toString().localeCompare(new ls.Multiaddr(h.multiaddr).toString())),p.certifiedRecord&&p.certifiedRecord.raw&&(t[c].peerRecordEnvelope=p.certifiedRecord.raw)}else f==="metadata"?t[c].metadata.push({key:l,value:i}):f==="keys"&&(t[c].pubKey=i)}e(33,"Read peer data from store");for(let o of n)await r.datastore.delete(o);e(66,"Removed existing peer data from store");for(let o of Object.keys(t)){let i=t[o];i.metadata=i.metadata.sort((a,u)=>a.key.localeCompare(u.key));let s=es.encode(i).finish();await r.datastore.put(new x(`/peers/${o}`),s)}await r.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function Rm(r,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await r.datastore.open();let t={},n=[];for await(let{key:o,value:i}of r.datastore.query({prefix:"/peers"})){n.push(o);let s=o.toString(),[a,u,f]=s.split("/");t[f]=es.decode(i)}e(33,"Read peer data from store");for(let o of n)await r.datastore.delete(o);e(66,"Removed existing peer data from store");for(let[o,i]of Object.entries(t)){if(i.protocols&&i.protocols.length>0&&await r.datastore.put(new x(`/peers/protos/${o}`),Ji.encode({protocols:i.protocols}).finish()),i.addresses&&i.addresses.length>0){let s=i.peerRecordEnvelope,a;if(s){let u=kf.decode(s),f=Pf.decode(u.payload);a={raw:s,seq:f.seq}}await r.datastore.put(new x(`/peers/addrs/${o}`),Zi.encode({addrs:i.addresses,certifiedRecord:a}).finish())}if(i.metadata&&i.metadata.length>0)for(let{key:s,value:a}of i.metadata)await r.datastore.put(new x(`/peers/metadata/${o}/${s}`),a);i.pubKey&&await r.datastore.put(new x(`/peers/keys/${o}`),i.pubKey)}await r.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}var gl={version:12,description:"Store each peerstore peer under a single datastore key",migrate:Bm,revert:Rm};var Mt={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},ho=[Object.assign({version:1},Mt),Object.assign({version:2},Mt),Object.assign({version:3},Mt),Object.assign({version:4},Mt),Object.assign({version:5},Mt),Object.assign({version:6},Mt),Object.assign({version:7},Mt),Va,Df,Cf,Sf,gl];var wl=A(qe(),1);var ps={};z(ps,{InvalidValueError:()=>wr,MissingRepoOptionsError:()=>Ge,NonReversibleMigrationError:()=>mr,NotInitializedRepoError:()=>Dt,RequiredParameterError:()=>gr});var mr=class extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=mr.code,this.message=e}};mr.code="ERR_NON_REVERSIBLE_MIGRATION";var Dt=class extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=Dt.code,this.message=e}};Dt.code="ERR_NOT_INITIALIZED_REPO";var gr=class extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=gr.code,this.message=e}};gr.code="ERR_REQUIRED_PARAMETER";var wr=class extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=wr.code,this.message=e}};wr.code="ERR_INVALID_VALUE";var Ge=class extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=Ge.code,this.message=e}};Ge.code="ERR_MISSING_REPO_OPTIONS";var hs=(0,wl.default)("ipfs:repo:migrator:repo:init");async function bl(r){if(!r)throw new Ge("Please pass repo options when trying to open a repo");let e=r.root;try{await e.open();let t=await e.has(Gr),n=await e.has(Ef);return!t||!n?(hs(`Version entry present: ${t}`),hs(`Config entry present: ${n}`),!1):!0}catch(t){return hs("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}Ke();_e();async function ys(r){if(!await bl(r))throw new Dt("Repo is not initialized!");let e=r.root;await e.open();try{return parseInt(re(await e.get(Gr)))}finally{await e.close()}}async function en(r,e){if(!e)throw new Ge("Please pass repo options when trying to open a repo");let t=e.root;await t.open(),await t.put(Gr,Y(String(r))),await t.close()}var Dl=A(qe(),1),$e=(0,Dl.default)("ipfs:repo:migrator");function Fm(r){return r=r||ho,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}async function vl(r,e,t,n,{ignoreLock:o=!1,onProgress:i,isDryRun:s=!1,migrations:a}){if(a=a||ho,!r)throw new Oe.RequiredParameterError("Path argument is required!");if(!t)throw new Oe.RequiredParameterError("repoOptions argument is required!");if(!n)throw new Oe.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new Oe.InvalidValueError("Version has to be positive integer!");e=Gi(e);let u=await ys(e);if(u===n){$e("Nothing to migrate.");return}if(u>n)throw new Oe.InvalidValueError(`Current repo's version (${u}) is higher then toVersion (${n}), you probably wanted to revert it?`);_l(a,u,n);let f;!s&&!o&&(f=await t.repoLock.lock(r));try{for(let c of a){if(n!==void 0&&c.version>n)break;if(!(c.version<=u)){$e(`Migrating version ${c.version}`);try{if(!s){let l=()=>{};i&&(l=(p,D)=>i(c.version,p.toFixed(2),D)),await c.migrate(e,l)}}catch(l){let p=c.version-1;throw $e(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${p}`),await en(p,e),new Error(`During migration to version ${c.version} exception was raised: ${l.stack||l.message||l}`)}$e(`Migrating to version ${c.version} finished`)}}s||await en(n||Fm(a),e),$e("Repo successfully migrated",n!==void 0?`to version ${n}!`:"to latest version!")}finally{!s&&!o&&f&&await f.close()}}async function El(r,e,t,n,{ignoreLock:o=!1,onProgress:i,isDryRun:s=!1,migrations:a}){if(a=a||ho,!r)throw new Oe.RequiredParameterError("Path argument is required!");if(!t)throw new Oe.RequiredParameterError("repoOptions argument is required!");if(!n)throw new Oe.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new Oe.InvalidValueError("Version has to be positive integer!");e=Gi(e);let u=await ys(e);if(u===n){$e("Nothing to revert.");return}if(u<n)throw new Oe.InvalidValueError(`Current repo's version (${u}) is lower then toVersion (${n}), you probably wanted to migrate it?`);_l(a,n,u,!0);let f;!s&&!o&&(f=await t.repoLock.lock(r)),$e(`Reverting from version ${u} to ${n}`);try{let c=a.slice().reverse();for(let l of c){if(l.version<=n)break;if(!(l.version>u)){$e(`Reverting migration version ${l.version}`);try{if(!s){let p=()=>{};i&&(p=(D,h)=>i(l.version,D.toFixed(2),h)),await l.revert(e,p)}}catch(p){let D=l.version;throw $e(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${D}`),await en(D,e),p.message=`During reversion to version ${l.version} exception was raised: ${p.message}`,p}$e(`Reverting to version ${l.version} finished`)}}s||await en(n,e),$e(`All migrations successfully reverted to version ${n}!`)}finally{!s&&!o&&f&&await f.close()}}function _l(r,e,t,n=!1){let o=0;for(let i of r){if(i.version>t)break;if(i.version>e){if(n&&!i.revert)throw new Oe.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${i.version} is not reversible. Cancelling reversion.`);o++}}if(o!==t-e)throw new Oe.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}var Oe=ps;var np=A(Al(),1);var Nl=A(Rl(),1),Fl=Nl.default;var jl=A(qe(),1);_e();Ke();var jt=class extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=jt.code}};jt.code="ERR_LOCK_EXISTS";var ye=class extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=ye.code}};ye.code="ERR_NOT_FOUND";var qt=class extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=qt.code}};qt.code="ERR_INVALID_REPO_VERSION";var tn="ERR_REPO_NOT_INITIALIZED",Ll="ERR_REPO_ALREADY_OPEN",$l="ERR_REPO_ALREADY_CLOSED";async function wo(r,e,t){let n=await e(r);if(n)return n;let o=Ml(t);return o?new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{i(Boolean(a.result))}}):!1}async function bo(r,e,t,n){if(await t(r))return e(r);let o=Ml(n);if(!o)throw new ye;return new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return i(a.result);s(new ye)}})}function Ml(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}var Gm=(0,jl.default)("ipfs:repo:version"),gs=new x("version");function ql(r){return{async exists(){return wo(gs,r.has.bind(r),r)},async get(){let e=await bo(gs,r.get.bind(r),r.has.bind(r),r);return parseInt(re(e),10)},set(e){return r.put(gs,Y(String(e)))},async check(e){let t=await this.get();return Gm("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}}}var Yl=A(bs(),1);var Ut=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},Ds=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},zl=r=>globalThis.DOMException===void 0?new Ds(r):new DOMException(r),Kl=r=>{let e=r.reason===void 0?zl("This operation was aborted."):r.reason;return e instanceof Error?e:zl(e)};function zt(r,e,t,n){let o,i=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(r);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:u}=n;u.aborted&&a(Kl(u)),u.addEventListener("abort",()=>{a(Kl(u))})}o=n.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{s(t())}catch(c){a(c)}return}let u=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,f=t instanceof Error?t:new Ut(u);typeof r.cancel=="function"&&r.cancel(),a(f)},e),(async()=>{try{s(await r)}catch(u){a(u)}finally{n.customTimers.clearTimeout.call(void 0,o)}})()});return i.clear=()=>{clearTimeout(o),o=void 0},i}function vs(r,e,t){let n=0,o=r.length;for(;o>0;){let i=Math.trunc(o/2),s=n+i;t(r[s],e)<=0?(n=++s,o-=i+1):o=i}return n}var Kt=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},st,nn=class{constructor(){st.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&Kt(this,st,"f")[this.size-1].priority>=t.priority){Kt(this,st,"f").push(n);return}let o=vs(Kt(this,st,"f"),n,(i,s)=>s.priority-i.priority);Kt(this,st,"f").splice(o,0,n)}dequeue(){let e=Kt(this,st,"f").shift();return e?.run}filter(e){return Kt(this,st,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Kt(this,st,"f").length}};st=new WeakMap;var N=function(r,e,t,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,t):o?o.value=t:e.set(r,t),t},w=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},q,sn,an,_t,Ao,un,vo,Me,on,me,Eo,ge,cn,Et,_o,Vl,Wl,Jl,Ql,Hl,Gl,xo,Es,_s,So,Co,Zm=new Ut,xs=class extends Error{},Vt=class extends Yl.default{constructor(e){var t,n,o,i;if(super(),q.add(this),sn.set(this,void 0),an.set(this,void 0),_t.set(this,0),Ao.set(this,void 0),un.set(this,void 0),vo.set(this,0),Me.set(this,void 0),on.set(this,void 0),me.set(this,void 0),Eo.set(this,void 0),ge.set(this,0),cn.set(this,void 0),Et.set(this,void 0),_o.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:nn,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(o=e.interval)===null||o===void 0?void 0:o.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);N(this,sn,e.carryoverConcurrencyCount,"f"),N(this,an,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),N(this,Ao,e.intervalCap,"f"),N(this,un,e.interval,"f"),N(this,me,new e.queueClass,"f"),N(this,Eo,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,N(this,_o,e.throwOnTimeout===!0,"f"),N(this,Et,e.autoStart===!1,"f")}get concurrency(){return w(this,cn,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);N(this,cn,e,"f"),w(this,q,"m",So).call(this)}async add(e,t={}){return new Promise((n,o)=>{let i=async()=>{var s,a,u;N(this,ge,(a=w(this,ge,"f"),a++,a),"f"),N(this,_t,(u=w(this,_t,"f"),u++,u),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){o(new xs("The task was aborted."));return}let c=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):zt(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?w(this,_o,"f"):t.throwOnTimeout)&&o(Zm)}));n(c),this.emit("completed",c)}catch(f){o(f),this.emit("error",f)}w(this,q,"m",Jl).call(this)};w(this,me,"f").enqueue(i,t),w(this,q,"m",xo).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return w(this,Et,"f")?(N(this,Et,!1,"f"),w(this,q,"m",So).call(this),this):this}pause(){N(this,Et,!0,"f")}clear(){N(this,me,new(w(this,Eo,"f")),"f")}async onEmpty(){w(this,me,"f").size!==0&&await w(this,q,"m",Co).call(this,"empty")}async onSizeLessThan(e){w(this,me,"f").size<e||await w(this,q,"m",Co).call(this,"next",()=>w(this,me,"f").size<e)}async onIdle(){w(this,ge,"f")===0&&w(this,me,"f").size===0||await w(this,q,"m",Co).call(this,"idle")}get size(){return w(this,me,"f").size}sizeBy(e){return w(this,me,"f").filter(e).length}get pending(){return w(this,ge,"f")}get isPaused(){return w(this,Et,"f")}};sn=new WeakMap,an=new WeakMap,_t=new WeakMap,Ao=new WeakMap,un=new WeakMap,vo=new WeakMap,Me=new WeakMap,on=new WeakMap,me=new WeakMap,Eo=new WeakMap,ge=new WeakMap,cn=new WeakMap,Et=new WeakMap,_o=new WeakMap,q=new WeakSet,Vl=function(){return w(this,an,"f")||w(this,_t,"f")<w(this,Ao,"f")},Wl=function(){return w(this,ge,"f")<w(this,cn,"f")},Jl=function(){var e;N(this,ge,(e=w(this,ge,"f"),e--,e),"f"),w(this,q,"m",xo).call(this),this.emit("next")},Ql=function(){this.emit("empty"),w(this,ge,"f")===0&&this.emit("idle")},Hl=function(){w(this,q,"m",_s).call(this),w(this,q,"m",Es).call(this),N(this,on,void 0,"f")},Gl=function(){let e=Date.now();if(w(this,Me,"f")===void 0){let t=w(this,vo,"f")-e;if(t<0)N(this,_t,w(this,sn,"f")?w(this,ge,"f"):0,"f");else return w(this,on,"f")===void 0&&N(this,on,setTimeout(()=>{w(this,q,"m",Hl).call(this)},t),"f"),!0}return!1},xo=function(){if(w(this,me,"f").size===0)return w(this,Me,"f")&&clearInterval(w(this,Me,"f")),N(this,Me,void 0,"f"),w(this,q,"m",Ql).call(this),!1;if(!w(this,Et,"f")){let e=!w(this,q,"a",Gl);if(w(this,q,"a",Vl)&&w(this,q,"a",Wl)){let t=w(this,me,"f").dequeue();return t?(this.emit("active"),t(),e&&w(this,q,"m",Es).call(this),!0):!1}}return!1},Es=function(){w(this,an,"f")||w(this,Me,"f")!==void 0||(N(this,Me,setInterval(()=>{w(this,q,"m",_s).call(this)},w(this,un,"f")),"f"),N(this,vo,Date.now()+w(this,un,"f"),"f"))},_s=function(){w(this,_t,"f")===0&&w(this,ge,"f")===0&&w(this,Me,"f")&&(clearInterval(w(this,Me,"f")),N(this,Me,void 0,"f")),N(this,_t,w(this,sn,"f")?w(this,ge,"f"):0,"f"),w(this,q,"m",So).call(this)},So=function(){for(;w(this,q,"m",xo).call(this););},Co=async function(e,t){return new Promise(n=>{let o=()=>{t&&!t()||(this.off(e,o),n())};this.on(e,o)})};var Xl=Xm;function Xm(r,e,t){var n,o;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(o=n.pop(),!o)return!1;Zl(o);for(var i;i=n.shift();)if(Zl(i),typeof r[i]>"u"&&(r[i]={}),r=r[i],!r||typeof r!="object")return!1;return r[o]=t,!0}function Zl(r){if(r=="__proto__"||r=="constructor"||r=="prototype")throw new Error("setting of prototype values not supported")}var Oo=A(Je(),1);_e();Ke();var eg=Vt.default?Vt.default:Vt,Cs=new x("config");function ed(r){let e=new eg({concurrency:1}),t={async getAll(i={}){let s=await bo(Cs,r.get.bind(r),r.has.bind(r),r);return JSON.parse(re(s))},async get(i,s={}){if(i==null)throw new ye(`Key ${i} does not exist in config`);let a=await this.getAll(s),u=Cr(a,i);if(u===void 0)throw new ye(`Key ${i} does not exist in config`);return u},set(i,s,a={}){if(typeof i!="string"&&!(i instanceof String))throw(0,Oo.default)(new Error("Invalid key type: "+typeof i),"ERR_INVALID_KEY");if(s===void 0||s instanceof Uint8Array)throw(0,Oo.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>n({key:i,value:s},a.signal))},replace(i,s={}){if(!i||i instanceof Uint8Array)throw(0,Oo.default)(new Error("Invalid value type: "+typeof i),"ERR_INVALID_VALUE");return e.add(()=>n({key:void 0,value:i},s.signal))},async exists(){return wo(Cs,r.has.bind(r),r)}};return t;async function n(i,s){if(s&&s.aborted)return;let a=i.key,u=i.value;if(a){let f=await t.getAll();return typeof f=="object"&&f!==null&&Xl(f,a,u),o(f)}return o(u)}function o(i){let s=Y(JSON.stringify(i,null,2));return r.put(Cs,s)}}function fn(r){if(typeof r!="object"||r===null)return!1;let e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)}function As(r,e={}){if(!fn(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t,compare:n}=e,o=[],i=[],s=u=>{let f=o.indexOf(u);if(f!==-1)return i[f];let c=[];return o.push(u),i.push(c),c.push(...u.map(l=>Array.isArray(l)?s(l):fn(l)?a(l):l)),c},a=u=>{let f=o.indexOf(u);if(f!==-1)return i[f];let c={},l=Object.keys(u).sort(n);o.push(u),i.push(c);for(let p of l){let D=u[p],h;t&&Array.isArray(D)?h=s(D):h=t&&fn(D)?a(D):D,Object.defineProperty(c,p,{...Object.getOwnPropertyDescriptor(u,p),value:h})}return c};return Array.isArray(r)?t?s(r):r.slice():a(r)}_e();Ke();var Ss=new x("datastore_spec");function td(r){return{exists(){return r.has(Ss)},async get(){let e=await r.get(Ss);return JSON.parse(re(e))},async set(e){return r.put(Ss,Y(JSON.stringify(As(e,{deep:!0}))))}}}Ke();var Os=new x("api");function rd(r){return{async get(){let e=await r.get(Os);return e&&e.toString()},set(e){return r.put(Os,Y(e.toString()))},delete(){return r.delete(Os)}}}var sd=A(Ts(),1);var To=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},vr=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new To(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new To(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function ko(r={}){return rg(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function rg(r,e){e=e??{};let t=e.onEnd,n=new vr,o,i,s,a=async()=>n.isEmpty()?s?{done:!0}:await new Promise((g,S)=>{i=R=>{i=null,n.push(R);try{g(r(n))}catch(G){S(G)}return o}}):r(n),u=g=>i!=null?i(g):(n.push(g),o),f=g=>(n=new vr,i!=null?i({error:g}):(n.push({error:g}),o)),c=g=>{if(s)return o;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:g})},l=g=>s?o:(s=!0,g!=null?f(g):u({done:!0})),p=()=>(n=new vr,l(),{done:!0}),D=g=>(l(g),{done:!0});if(o={[Symbol.asyncIterator](){return this},next:a,return:p,throw:D,push:c,end:l,get readableLength(){return n.size}},t==null)return o;let h=o;return o={[Symbol.asyncIterator](){return this},next(){return h.next()},throw(g){return h.throw(g),t!=null&&(t(g),t=void 0),{done:!0}},return(){return h.return(),t!=null&&(t(),t=void 0),{done:!0}},push:c,end(g){return h.end(g),t!=null&&(t(g),t=void 0),o},get readableLength(){return h.readableLength}},o}var ad=A(id(),1);fe();var ud=A(Je(),1);fi();function cd(r){return{open(){return r.open()},close(){return r.close()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let n=xt(e);return n.isIdentity?Promise.resolve(n.digest):r.get(e,t)},async*getMany(e,t){for await(let n of e)yield this.get(n,t)},async put(e,t,n){let{isIdentity:o}=xt(e);o||await r.put(e,t,n)},async*putMany(e,t){let n=ko({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,ad.default)(r.putMany(async function*(){for await(let{key:i,value:s}of e)xt(i).isIdentity||(yield{key:i,value:s}),n.push({key:i,value:s})}())),n.end()}catch(i){n.end(i)}}),yield*n},has(e,t){let{isIdentity:n}=xt(e);return n?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:n}=xt(e);return n?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany((0,sd.default)(e,n=>!xt(n).isIdentity),t)},batch(){let e=r.batch();return{put(t,n){let{isIdentity:o}=xt(t);o||e.put(t,n)},delete(t){let{isIdentity:n}=xt(t);n||e.delete(t)},commit:t=>e.commit(t)}}}}function xt(r){let e=E.asCID(r);if(e==null)throw(0,ud.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==ui.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}var fd=A(qe(),1),ld=(0,fd.default)("ipfs:repo:lock:memory"),dd="repo.lock",ln={};async function og(r){let e=r+"/"+dd;if(ld("locking %s",e),ln[e]===!0)throw new jt(`Lock already being held for file: ${e}`);return ln[e]=!0,{async close(){ln[e]&&delete ln[e]}}}async function ig(r){let e=r+"/"+dd;return ld(`checking lock: ${e}`),Boolean(ln[e])}var pd={lock:og,locked:ig};var hd={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:pd};var ks={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};fe();var bd=A(Je(),1),Dd=A(qe(),1),Ns=A(md(),1);In();var Io=({enumerable:r=!0,configurable:e=!1}={})=>({enumerable:r,configurable:e,writable:!1}),Is=function*(r,e){if(r!=null&&!(r instanceof Uint8Array))for(let[t,n]of Object.entries(r)){let o=[...e,t];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[i,s]of n.entries()){let a=[...o,i],u=E.asCID(s);u?yield[a.join("/"),u]:typeof s=="object"&&(yield*Is(s,a))}else{let i=E.asCID(n);i?yield[o.join("/"),i]:yield*Is(n,o)}}},Ps=function*(r,e){if(r!=null)for(let[t,n]of Object.entries(r)){let o=[...e,t];if(yield o.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!E.asCID(n))if(Array.isArray(n))for(let[i,s]of n.entries()){let a=[...o,i];yield a.join("/"),typeof s=="object"&&!E.asCID(s)&&(yield*Ps(s,a))}else yield*Ps(n,o)}},ag=(r,e)=>{let t=r;for(let[n,o]of e.entries()){if(t=t[o],t==null)throw new Error(`Object has no property at ${e.slice(0,n+1).map(s=>`[${JSON.stringify(s)}]`).join("")}`);let i=E.asCID(t);if(i)return{value:i,remaining:e.slice(n+1).join("/")}}return{value:t}},Bs=class{constructor({cid:e,bytes:t,value:n}){if(!e||!t||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:Io(),bytes:Io(),value:Io(),asBlock:Io()})}links(){return Is(this.value,[])}tree(){return Ps(this.value,[])}get(e="/"){return ag(this.value,e.split("/").filter(Boolean))}};var Po=({bytes:r,cid:e,value:t,codec:n})=>{let o=t!==void 0?t:n&&n.decode(r);if(o===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Bs({cid:e,bytes:r,value:o})};In();kn();var gd=A(Je(),1);et();Xe();function dn(r){let e=E.asCID(r);if(e==null)throw(0,gd.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let t=M.encode(e.multihash.bytes);return new x("/"+t.slice(1).toUpperCase(),!1)}function Rs(r){return Ze(M.decode(`b${r.toString().toLowerCase().substring(1)}`))}var wd=A(qe(),1);var ug=(0,wd.default)("ipfs:repo:utils:walk-dag");async function*Er(r,e,t,n){try{let o=await e.get(r,n),i=await t(r.code),s=Po({bytes:o,cid:r,codec:i});for(let[,a]of s.links())yield a,yield*Er(a,e,t,n)}catch(o){throw ug("Could not walk DAG for CID",r.toString(),o),o}}var se={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function cg(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return(0,bd.default)(new Error(e),"ERR_INVALID_PIN_TYPE")}var Bo=class{constructor({pinstore:e,blockstore:t,loadCodec:n}){this.pinstore=e,this.blockstore=t,this.loadCodec=n,this.log=(0,Dd.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let n={depth:0};return e.version!==0&&(n.version=e.version),e.code!==rt&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),this.pinstore.put(dn(e),Pt(n))}unpin(e,t){return this.pinstore.delete(dn(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let n={depth:1/0};e.version!==0&&(n.version=e.version),e.code!==rt&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),await this.pinstore.put(dn(e),Pt(n))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[n=>We(n.value).depth===0]})){let n=We(t.value),o=n.version||0,i=n.codec!=null?n.codec:rt,s=Rs(t.key);yield{cid:E.create(o,i,s),metadata:n.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[n=>We(n.value).depth===1/0]})){let n=We(t.value),o=n.version||0,i=n.codec!=null?n.codec:rt,s=Rs(t.key);yield{cid:E.create(o,i,s),metadata:n.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let n of Er(t,this.blockstore,this.loadCodec,e)){let o=[se.recursive];(await this.isPinnedWithType(n,o)).pinned||(yield n)}}async isPinnedWithType(e,t,n){Array.isArray(t)||(t=[t]);let o=t.includes(se.all),i=t.includes(se.direct),s=t.includes(se.recursive),a=t.includes(se.indirect);if(s||i||o){let c=await(0,Ns.default)(this.pinstore.query({prefix:dn(e).toString(),filters:[l=>{if(o)return!0;let p=We(l.value);return t.includes(p.depth===0?se.direct:se.recursive)}],limit:1}));if(c){let l=We(c.value);return{cid:e,pinned:!0,reason:l.depth===0?se.direct:se.recursive,metadata:l.metadata}}}let u=this;async function*f(c,l){for await(let{cid:p}of l)for await(let D of Er(p,u.blockstore,u.loadCodec))if(D.equals(c)){yield p;return}}if(o||a){let c=await(0,Ns.default)(f(e,this.recursiveKeys()));if(c)return{cid:e,pinned:!0,reason:se.indirect,parent:c}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){let n=new Set,o=async(i,s)=>{if(n.has(i.toString()))return;n.add(i.toString());let a=await this.blockstore.get(i,s),u=await this.loadCodec(i.code),f=Po({bytes:a,cid:i,codec:u});await Promise.all([...f.links()].map(([,c])=>o(c,s)))};await o(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(se).includes(e))throw cg(e);return!0}};var _d=A(Fs(),1),xd=A(Je(),1);function Cd(r,e){return{open(){return e.open()},close(){return e.close()},query(t,n){return e.query(t,n)},queryKeys(t,n){return e.queryKeys(t,n)},async get(t,n){return e.get(t,n)},async*getMany(t,n){yield*e.getMany(t,n)},async put(t,n,o){await e.put(t,n,o)},async*putMany(t,n){yield*e.putMany(t,n)},has(t,n){return e.has(t,n)},async delete(t,n){return await Ed(t,r),e.delete(t,n)},deleteMany(t,n){return e.deleteMany((0,_d.default)(t,async o=>(await Ed(o,r),o)),n)},batch(){return e.batch()}}}async function Ed(r,e){let{pinned:t,reason:n}=await e.isPinnedWithType(r,se.all);if(t)throw(0,xd.default)(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}var Pd=A(bs(),1);function Ls(r,e,t){let n=0,o=r.length;for(;o>0;){let i=Math.trunc(o/2),s=n+i;t(r[s],e)<=0?(n=++s,o-=i+1):o=i}return n}var Wt=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},at,pn=class{constructor(){at.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&Wt(this,at,"f")[this.size-1].priority>=t.priority){Wt(this,at,"f").push(n);return}let o=Ls(Wt(this,at,"f"),n,(i,s)=>s.priority-i.priority);Wt(this,at,"f").splice(o,0,n)}dequeue(){let e=Wt(this,at,"f").shift();return e?.run}filter(e){return Wt(this,at,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Wt(this,at,"f").length}};at=new WeakMap;var F=function(r,e,t,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,t):o?o.value=t:e.set(r,t),t},b=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},U,yn,mn,At,Mo,gn,Ro,je,hn,we,No,be,wn,Ct,Fo,Ad,Sd,Id,Od,Td,kd,Lo,$s,Ms,jo,$o,lg=new Ut,js=class extends Error{},_r=class extends Pd.default{constructor(e){var t,n,o,i;if(super(),U.add(this),yn.set(this,void 0),mn.set(this,void 0),At.set(this,0),Mo.set(this,void 0),gn.set(this,void 0),Ro.set(this,0),je.set(this,void 0),hn.set(this,void 0),we.set(this,void 0),No.set(this,void 0),be.set(this,0),wn.set(this,void 0),Ct.set(this,void 0),Fo.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:pn,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(o=e.interval)===null||o===void 0?void 0:o.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);F(this,yn,e.carryoverConcurrencyCount,"f"),F(this,mn,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),F(this,Mo,e.intervalCap,"f"),F(this,gn,e.interval,"f"),F(this,we,new e.queueClass,"f"),F(this,No,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,F(this,Fo,e.throwOnTimeout===!0,"f"),F(this,Ct,e.autoStart===!1,"f")}get concurrency(){return b(this,wn,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);F(this,wn,e,"f"),b(this,U,"m",jo).call(this)}async add(e,t={}){return new Promise((n,o)=>{let i=async()=>{var s,a,u;F(this,be,(a=b(this,be,"f"),a++,a),"f"),F(this,At,(u=b(this,At,"f"),u++,u),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){o(new js("The task was aborted."));return}let c=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):zt(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?b(this,Fo,"f"):t.throwOnTimeout)&&o(lg)}));n(c),this.emit("completed",c)}catch(f){o(f),this.emit("error",f)}b(this,U,"m",Id).call(this)};b(this,we,"f").enqueue(i,t),b(this,U,"m",Lo).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return b(this,Ct,"f")?(F(this,Ct,!1,"f"),b(this,U,"m",jo).call(this),this):this}pause(){F(this,Ct,!0,"f")}clear(){F(this,we,new(b(this,No,"f")),"f")}async onEmpty(){b(this,we,"f").size!==0&&await b(this,U,"m",$o).call(this,"empty")}async onSizeLessThan(e){b(this,we,"f").size<e||await b(this,U,"m",$o).call(this,"next",()=>b(this,we,"f").size<e)}async onIdle(){b(this,be,"f")===0&&b(this,we,"f").size===0||await b(this,U,"m",$o).call(this,"idle")}get size(){return b(this,we,"f").size}sizeBy(e){return b(this,we,"f").filter(e).length}get pending(){return b(this,be,"f")}get isPaused(){return b(this,Ct,"f")}};yn=new WeakMap,mn=new WeakMap,At=new WeakMap,Mo=new WeakMap,gn=new WeakMap,Ro=new WeakMap,je=new WeakMap,hn=new WeakMap,we=new WeakMap,No=new WeakMap,be=new WeakMap,wn=new WeakMap,Ct=new WeakMap,Fo=new WeakMap,U=new WeakSet,Ad=function(){return b(this,mn,"f")||b(this,At,"f")<b(this,Mo,"f")},Sd=function(){return b(this,be,"f")<b(this,wn,"f")},Id=function(){var e;F(this,be,(e=b(this,be,"f"),e--,e),"f"),b(this,U,"m",Lo).call(this),this.emit("next")},Od=function(){this.emit("empty"),b(this,be,"f")===0&&this.emit("idle")},Td=function(){b(this,U,"m",Ms).call(this),b(this,U,"m",$s).call(this),F(this,hn,void 0,"f")},kd=function(){let e=Date.now();if(b(this,je,"f")===void 0){let t=b(this,Ro,"f")-e;if(t<0)F(this,At,b(this,yn,"f")?b(this,be,"f"):0,"f");else return b(this,hn,"f")===void 0&&F(this,hn,setTimeout(()=>{b(this,U,"m",Td).call(this)},t),"f"),!0}return!1},Lo=function(){if(b(this,we,"f").size===0)return b(this,je,"f")&&clearInterval(b(this,je,"f")),F(this,je,void 0,"f"),b(this,U,"m",Od).call(this),!1;if(!b(this,Ct,"f")){let e=!b(this,U,"a",kd);if(b(this,U,"a",Ad)&&b(this,U,"a",Sd)){let t=b(this,we,"f").dequeue();return t?(this.emit("active"),t(),e&&b(this,U,"m",$s).call(this),!0):!1}}return!1},$s=function(){b(this,mn,"f")||b(this,je,"f")!==void 0||(F(this,je,setInterval(()=>{b(this,U,"m",Ms).call(this)},b(this,gn,"f")),"f"),F(this,Ro,Date.now()+b(this,gn,"f"),"f"))},Ms=function(){b(this,At,"f")===0&&b(this,be,"f")===0&&b(this,je,"f")&&(clearInterval(b(this,je,"f")),F(this,je,void 0,"f")),F(this,At,b(this,yn,"f")?b(this,be,"f"):0,"f"),b(this,U,"m",jo).call(this)},jo=function(){for(;b(this,U,"m",Lo).call(this););},$o=async function(e,t){return new Promise(n=>{let o=()=>{t&&!t()||(this.off(e,o),n())};this.on(e,o)})};var qs="lock:worker:request-read",Us="lock:worker:release-read",zs="lock:master:grant-read",Ks="lock:worker:request-write",Vs="lock:worker:release-write",Ws="lock:master:grant-write";var St={},xr=r=>{r.addEventListener("message",e=>{xr.dispatchEvent("message",r,e)}),r.port!=null&&r.port.addEventListener("message",e=>{xr.dispatchEvent("message",r,e)})};xr.addEventListener=(r,e)=>{St[r]==null&&(St[r]=[]),St[r].push(e)};xr.removeEventListener=(r,e)=>{St[r]!=null&&(St[r]=St[r].filter(t=>t===e))};xr.dispatchEvent=function(r,e,t){St[r]!=null&&St[r].forEach(n=>n(e,t))};var Qs=xr;var Bd=(r,e,t,n,o)=>(i,s)=>{if(s.data.type!==t)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};r.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(i.postMessage({type:o,name:a.name,identifier:a.identifier}),await new Promise(u=>{let f=c=>{if(c==null||c.data==null)return;let l={type:c.data.type,name:c.data.name,identifier:c.data.identifier};l.type===n&&l.identifier===a.identifier&&(i.removeEventListener("message",f),u())};i.addEventListener("message",f)}))}}))},Rd=(r,e,t,n)=>async()=>{let o=On();return globalThis.postMessage({type:e,identifier:o,name:r}),await new Promise(i=>{let s=a=>{if(a==null||a.data==null)return;let u={type:a.data.type,identifier:a.data.identifier};u.type===t&&u.identifier===o&&(globalThis.removeEventListener("message",s),i(()=>{globalThis.postMessage({type:n,identifier:o,name:r})}))};globalThis.addEventListener("message",s)})},dg={singleProcess:!1},Nd=r=>{if(r=Object.assign({},dg,r),Boolean(globalThis.document)||r.singleProcess){let t=new EventTarget;return Qs.addEventListener("message",Bd(t,"requestReadLock",qs,Us,zs)),Qs.addEventListener("message",Bd(t,"requestWriteLock",Ks,Vs,Ws)),t}return{isWorker:!0,readLock:t=>Rd(t,qs,zs,Us),writeLock:t=>Rd(t,Ks,Ws,Vs)}};var Qt={},Ot;async function Hs(r,e){let t,n=new Promise(o=>{t=o});return r.add(async()=>await zt((async()=>await new Promise(o=>{t(()=>{o()})}))(),e.timeout)),await n}var pg=(r,e)=>{if(Ot.isWorker===!0)return{readLock:Ot.readLock(r,e),writeLock:Ot.writeLock(r,e)};let t=new _r({concurrency:1}),n;return{async readLock(){if(n!=null)return await Hs(n,e);n=new _r({concurrency:e.concurrency,autoStart:!1});let o=n,i=Hs(n,e);return t.add(async()=>(o.start(),await o.onIdle().then(()=>{n===o&&(n=null)}))),await i},async writeLock(){return n=null,await Hs(t,e)}}},hg={name:"lock",concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};function Gs(r){let e=Object.assign({},hg,r);return Ot==null&&(Ot=Nd(e),Ot.isWorker!==!0&&(Ot.addEventListener("requestReadLock",t=>{Qt[t.data.name]!=null&&Qt[t.data.name].readLock().then(async n=>await t.data.handler().finally(()=>n()))}),Ot.addEventListener("requestWriteLock",async t=>{Qt[t.data.name]!=null&&Qt[t.data.name].writeLock().then(async n=>await t.data.handler().finally(()=>n()))}))),Qt[e.name]==null&&(Qt[e.name]=pg(e.name,e)),Qt[e.name]}fe();var Yd=A(qe(),1);var Zd=A(Md(),1);var Hd=A(Ys(),1),Dg=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},Gd=r=>r!=null&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),Zs=r=>r!=null&&typeof r.sink=="function"&&Gd(r.source),vg=r=>e=>{let t=r.sink(e);if(t.then!=null){let n=ko({objectMode:!0});return t.then(()=>{n.end()},i=>{n.end(i)}),(0,Hd.default)(n,async function*(){yield*r.source,n.end()}())}return r.source};function Jd(r,...e){if(Zs(r)){let n=r;r=()=>n.source}else if(Gd(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&Zs(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)Zs(t[n])&&(t[n]=vg(t[n]));return Dg(...t)}var Xs=A(Ys(),1),qo=A(Fs(),1),Xd=A(Ts(),1);et();var bn=(0,Yd.default)("ipfs:repo:gc"),Eg=Hr().code,_g=256,xg=new x("/local/filesroot");function ep({gcLock:r,pins:e,blockstore:t,root:n,loadCodec:o}){async function*i(){let s=Date.now();bn("Creating set of marked blocks");let a=await r.writeLock();try{let u=await Cg({pins:e,blockstore:t,root:n,loadCodec:o}),f=t.queryKeys({});yield*Ag({blockstore:t},u,f),bn(`Complete (${Date.now()-s}ms)`)}finally{a()}}return i}async function Cg({pins:r,blockstore:e,loadCodec:t,root:n}){let o=async function*(){let a;try{a=await n.get(xg)}catch(f){if(f.code===Eg){bn("No blocks in MFS");return}throw f}let u=E.decode(a);yield u,yield*Er(u,e,t)}(),i=(0,Xs.default)((0,qo.default)(r.recursiveKeys(),({cid:a})=>a),r.indirectKeys(),(0,qo.default)(r.directKeys(),({cid:a})=>a),o),s=new Set;for await(let a of(0,Xs.default)(i,o))s.add(M.encode(a.multihash.bytes));return s}async function*Ag({blockstore:r},e,t){let n=0,o=0;yield*Jd((0,Zd.default)((0,qo.default)(t,async s=>async function(){n++;try{let u=M.encode(s.multihash.bytes);if(e.has(u))return null;try{await r.delete(s),o++}catch(f){return{err:new Error(`Could not delete block with CID ${s}: ${f.message}`)}}return{cid:s}}catch(u){let f=`Could delete block with CID ${s}`;return bn(f,u),{err:new Error(f+`: ${u.message}`)}}}),_g),s=>(0,Xd.default)(s,Boolean)),bn(`Marked set has ${e.size} unique blocks. Blockstore has ${n} blocks. Deleted ${o} blocks.`)}var ae=(0,rp.default)("ipfs:repo"),Sg=Number.MAX_SAFE_INTEGER,Og="repoAutoMigrate",ta=class{constructor(e,t,n,o){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=Fl(hd,o),this.closed=!0,this.path=e,this.root=n.root,this.datastore=n.datastore,this.keys=n.keys;let i=n.blocks,s=n.pins;this.pins=new Bo({pinstore:s,blockstore:i,loadCodec:t});let a=Cd(this.pins,i);this.blocks=cd(a),this.version=ql(this.root),this.config=ed(this.root),this.spec=td(this.root),this.apiAddr=rd(this.root),this.gcLock=Gs({name:e,singleProcess:this.options.repoOwner!==!1}),this.gc=ep({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){ae("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(kg(e)),await this.spec.set(Ig(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw(0,Ht.default)(new Error("repo is already open"),Ll);ae("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),ae("acquired repo.lock"),!await this.version.check(12))if(await this._isAutoMigrationEnabled())await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new qt("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");ae("creating datastore"),await this.datastore.open(),ae("creating blocks"),await this.blocks.open(),ae("creating keystore"),await this.keys.open(),ae("creating pins"),await this.pins.pinstore.open(),this.closed=!1,ae("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){ae("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Ht.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){ae("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?(0,Ht.default)(new Error("repo is not initialized yet"),tn,{path:this.path}):t}if(!e)throw(0,Ht.default)(new Error("repo is not initialized yet"),tn,{path:this.path})}async close(){if(this.closed)throw(0,Ht.default)(new Error("repo is already closed"),$l);ae("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==tn&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),ae("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,n,o,i]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),tp(this.datastore),tp(this.keys)]),s=t.size+o+i;return{repoPath:this.path,storageMax:e,version:n,numObjects:t.count,repoSize:s}}throw(0,Ht.default)(new Error("repo is not initialized yet"),tn,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(Og)}catch(t){if(t.code===ye.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(ae(`reverting to version ${e}`),El(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(ae(`migrating to version ${e}`),vl(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,np.default)(e))}catch{return BigInt(Sg)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:n,value:o}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(o.byteLength),t+=BigInt(n.bytes.byteLength);return{count:e,size:t}}};async function tp(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function Tg(r,e,t,n){return new ta(r,e,t,n)}function kg(r){return r.Datastore=Object.assign({},ks,Cr(r,"datastore")),r}function Ig(r){let e={...ks.Spec,...Cr(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}return te(Pg);})();
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
return IpfsRepo}));
